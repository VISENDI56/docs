---
title: Security stack
description: Sovereign Health Security Architecture and Core IP Stack
---

## Overview

The iLuminara-Core security stack implements a **Sovereign Health Security Architecture** with continuous security attestation, cryptographic data dissolution, and compliance-first design.

<Card
  title="Philosophy"
  icon="shield-halved"
>
  "Security is not built once. It is continuously attested."
</Card>

## The 10/10 security stack

| Component | iLuminara Protocol | Benefit |
|-----------|-------------------|---------|
| **Security Audit** | Gitleaks + CodeQL | Continuous attestation of the Fortress |
| **Data Lifecycle** | IP-02 Crypto Shredder | Data is dissolved, not deleted |
| **Intelligence** | IP-04 Silent Flux | AI output regulated by operator anxiety |
| **Connectivity** | IP-06 5DM Bridge | Direct injection into 14M+ African mobile nodes |

## Security layers

<Steps>
  <Step title="Security audit layer">
    CodeQL SAST scanning, Gitleaks secret detection, Dependabot daily updates
  </Step>
  <Step title="Governance kernel">
    SovereignGuardrail enforcement, Crypto Shredder (IP-02), Ethical Engine
  </Step>
  <Step title="Hardware attestation">
    TPM-based trust, Bill-of-Materials ledger, Acorn Protocol (IP-03)
  </Step>
  <Step title="Network security">
    LoRa mesh networking, VPN tunneling, TLS 1.3 encryption
  </Step>
</Steps>

## Security audit layer

### CodeQL SAST scanning

Continuous static application security testing with security-extended queries.

**Workflow:** `.github/workflows/codeql.yml`

```yaml
name: "CodeQL Security Analysis"

on:
  push:
    branches: [ "main", "develop" ]
  pull_request:
    branches: [ "main" ]
  schedule:
    - cron: '0 0 * * 0'  # Weekly
```

**Compliance:**
- GDPR Art. 32 (Security of Processing)
- ISO 27001 A.12.6 (Technical Vulnerability Management)
- SOC 2 (Security Monitoring)

### Gitleaks secret scanning

Detects hardcoded secrets, API keys, and credentials in code.

**Workflow:** `.github/workflows/gitleaks.yml`

```yaml
name: "Gitleaks Secret Scanning"

on:
  push:
    branches: [ "main", "develop" ]
  schedule:
    - cron: '0 2 * * *'  # Daily at 2 AM UTC
```

**Compliance:**
- NIST SP 800-53 (IA-5 Authenticator Management)
- HIPAA ยง164.312(a)(2)(i) (Unique User Identification)

### Dependabot security updates

Daily automated security updates for dependencies.

**Configuration:** `.github/dependabot.yml`

```yaml
version: 2

updates:
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "daily"
      time: "02:00"
```

## Post-quantum cryptography (PQC) stack

In 2026, "standard encryption" is a liability for long-term health records. iLuminara implements **NIST FIPS 203/204** post-quantum cryptography:

| Layer | Algorithm | Purpose | NIST Standard |
|-------|-----------|---------|---------------|
| **Identity** | ML-DSA-65 (Dilithium) | Tamper-proof digital signatures for every medical record | FIPS 204 |
| **Secrets** | ML-KEM-768 (Kyber) | Quantum-safe key encapsulation for data-at-rest | FIPS 203 |
| **Integrity** | BLAKE3 | Ultra-fast hashing for the Sovereign Audit Trail | - |

### Cryptographic hardening

```python
from governance_kernel.pqc_sealer import PQCSealer
from kyber import Kyber768
from dilithium import Dilithium3

# Initialize PQC sealer
sealer = PQCSealer(
    kem_algorithm=Kyber768,
    signature_algorithm=Dilithium3
)

# Seal medical record with post-quantum cryptography
sealed_record = sealer.seal_evidence(
    data=patient_record,
    metadata={"patient_id": "PAT_001", "jurisdiction": "KDPA_KE"}
)

# Generate audit bundle with PQC signatures
audit_bundle = sealer.generate_audit_bundle(
    records=[sealed_record],
    authority="UNHCR_Dadaab"
)
```

**Compliance:**
- NIST FIPS 203 (ML-KEM Key Encapsulation)
- NIST FIPS 204 (ML-DSA Digital Signatures)
- GDPR Art. 32 (State-of-the-art security measures)
- HIPAA ยง164.312(a)(2)(iv) (Encryption and decryption)

## Nuclear IP Stack

### IP-02: Crypto Shredder

Data is not deleted; it is cryptographically dissolved.

```python
from governance_kernel.crypto_shredder import CryptoShredder, RetentionPolicy

shredder = CryptoShredder(sovereignty_zone=SovereigntyZone.KENYA)

# Encrypt with ephemeral key
encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_record,
    retention_policy=RetentionPolicy.HOT,
    metadata={\"patient_id\": \"12345\", \"jurisdiction\": \"KDPA_KE\"}
)

# After retention period, shred the key
shredder.shred_key(key_id)

# Data is now cryptographically irrecoverable
```

**Compliance:**
- GDPR Art. 17 (Right to Erasure)
- HIPAA ยง164.530(j) (Documentation)
- NIST SP 800-88 (Media Sanitization)

### IP-03: Acorn Protocol

Somatic security using posture + location + stillness as cryptographic authentication.

**Status:** Requires hardware attestation (TPM)

**Use case:** Prevents "panic access" during crises by requiring physical stillness for high-risk operations.

### IP-04: Silent Flux

Anxiety-regulated AI output that prevents information overload.

**Status:** Requires integration with operator monitoring

**Use case:** AI agents reduce output verbosity when operator anxiety is detected, preventing cognitive overload during emergencies.

### IP-05: Golden Thread

Quantum-inspired correlation logic to fuse distributed signals into verified timelines.

```python
from edge_node.sync_protocol.golden_thread import GoldenThread

gt = GoldenThread()

# Merge CBS and EMR signals
fused = gt.fuse_data_streams(
    cbs_signal={\"location\": \"Dadaab\", \"symptom\": \"fever\"},
    emr_record={\"location\": \"Dadaab\", \"diagnosis\": \"malaria\"},
    patient_id=\"PAT_001\"
)

# Verification score: 1.0 (CONFIRMED)
```

### IP-06: 5DM Bridge

API-level injection into 14M+ African mobile nodes (94% CAC reduction).

**Status:** Requires mobile network integration

**Use case:** Direct integration with mobile health platforms for zero-friction data collection.

## SovereignGuardrail configuration

The Fortress is configured via `config/sovereign_guardrail.yaml`:

```yaml
jurisdiction:
  primary: "KDPA_KE"
  secondary:
    - "GDPR_EU"
    - "POPIA_ZA"
    - "HIPAA_US"

sovereignty:
  data_residency:
    enabled: true
    allowed_zones:
      - "africa-south1"
      - "europe-west1"
    enforcement_level: "STRICT"

audit:
  enabled: true
  tamper_proof: true
  storage:
    backend: "Cloud_Spanner"
    retention_days: 2555  # 7 years (HIPAA)
```

## Fortress validation

Validate the complete security stack:

```bash
chmod +x scripts/validate_fortress.sh
./scripts/validate_fortress.sh
```

**Validation phases:**
1. Security Audit Layer (CodeQL, Gitleaks, Dependabot)
2. Governance Kernel (SovereignGuardrail, Crypto Shredder)
3. Edge Node & AI Agents
4. Cloud Oracle
5. Python Dependencies
6. Environment Configuration
7. Nuclear IP Stack Status

## Security monitoring

### Prometheus metrics

```
sovereignty_violations_total
cross_border_transfers_total
high_risk_inferences_total
keys_shredded_total
```

### Grafana dashboards

- **Sovereignty Compliance** - Real-time compliance monitoring
- **Audit Trail** - Tamper-proof audit visualization
- **Data Retention** - Key lifecycle and auto-shred status

## Threat model

<AccordionGroup>
  <Accordion title="Data exfiltration">
    **Mitigation:** SovereignGuardrail blocks cross-border transfers, Gitleaks detects hardcoded credentials
  </Accordion>
  <Accordion title="Unauthorized access">
    **Mitigation:** Acorn Protocol (somatic authentication), TPM hardware attestation
  </Accordion>
  <Accordion title="Data retention violations">
    **Mitigation:** Crypto Shredder auto-shreds expired keys, retention policies enforced
  </Accordion>
  <Accordion title="Supply chain attacks">
    **Mitigation:** Dependabot daily updates, CodeQL SAST scanning, Bill-of-Materials ledger
  </Accordion>
  <Accordion title="Insider threats">
    **Mitigation:** Tamper-proof audit trail, role-based access control, anomaly detection
  </Accordion>
</AccordionGroup>

## Incident response

<Steps>
  <Step title="Detection">
    Security workflows trigger alerts on violations
  </Step>
  <Step title="Containment">
    SovereignGuardrail automatically blocks violating actions
  </Step>
  <Step title="Investigation">
    Tamper-proof audit trail provides complete forensics
  </Step>
  <Step title="Remediation">
    Crypto Shredder immediately dissolves compromised data
  </Step>
  <Step title="Recovery">
    Golden Thread reconstructs verified timeline from multiple sources
  </Step>
</Steps>

## Compliance attestation

The security architecture provides continuous compliance attestation:

| Framework | Attestation Method | Frequency |
|-----------|-------------------|-----------|
| GDPR | SovereignGuardrail + Audit Trail | Real-time |
| HIPAA | Crypto Shredder + Retention Policies | Daily |
| ISO 27001 | CodeQL + Gitleaks | Weekly |
| SOC 2 | Tamper-proof Audit | Continuous |
| NIST CSF | Security Workflows | Daily |

## Next steps

<CardGroup cols={2}>
  <Card
    title="Governance kernel"
    icon="shield-check"
    href="/governance/overview"
  >
    Configure compliance enforcement
  </Card>
  <Card
    title="Architecture"
    icon="sitemap"
    href="/architecture/overview"
  >
    Understand system architecture
  </Card>
  <Card
    title="AI agents"
    icon="brain-circuit"
    href="/ai-agents/overview"
  >
    Deploy autonomous surveillance
  </Card>
  <Card
    title="Deployment"
    icon="rocket"
    href="/deployment/overview"
  >
    Deploy to production
  </Card>
</CardGroup>
