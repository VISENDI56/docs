---
title: Crypto Shredder (IP-02)
description: Data is not deleted; it is cryptographically dissolved
---

## Overview

IP-02 Crypto Shredder implements a revolutionary approach to data deletion: instead of deleting data, we encrypt it with ephemeral keys and then shred the keys after the retention period. The data becomes cryptographically irrecoverable.

<Card
  title="Philosophy"
  icon="fire"
>
  "Data is not deleted; it is cryptographically dissolved."
</Card>

## Why Crypto Shredder?

Traditional data deletion has fundamental problems:

<AccordionGroup>
  <Accordion title="Problem 1: Deletion is not guaranteed">
    SSDs, cloud storage, and backups make true deletion impossible. Data persists in unexpected places.
  </Accordion>
  <Accordion title="Problem 2: Compliance is difficult">
    GDPR Art. 17 "Right to Erasure" requires verifiable deletion. How do you prove data is gone?
  </Accordion>
  <Accordion title="Problem 3: Recovery is impossible">
    Once deleted, data cannot be recovered even if legally required (e.g., court order).
  </Accordion>
</AccordionGroup>

**Crypto Shredder solves all three:**
1. Data remains encrypted (no deletion needed)
2. Key shredding is verifiable and auditable
3. Data is cryptographically irrecoverable (provably gone)

## How it works

<Steps>
  <Step title="Encrypt with ephemeral key">
    Generate a unique 256-bit AES key for each data record
  </Step>
  <Step title="Store encrypted data">
    Save encrypted data with retention policy metadata
  </Step>
  <Step title="Shred key after retention">
    Overwrite key with random data (DoD 5220.22-M standard)
  </Step>
  <Step title="Data becomes irrecoverable">
    Without the key, encrypted data is cryptographically useless
  </Step>
</Steps>

## Basic usage

```python
from governance_kernel.crypto_shredder import CryptoShredder, RetentionPolicy, SovereigntyZone

# Initialize Crypto Shredder
shredder = CryptoShredder(
    sovereignty_zone=SovereigntyZone.KENYA,
    enable_audit=True
)

# Encrypt patient data
patient_data = b"Patient ID: 12345, Diagnosis: Malaria, Location: Dadaab"

encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT,
    metadata={
        "patient_id": "12345",
        "jurisdiction": "KDPA_KE",
        "data_type": "PHI"
    }
)

print(f"âœ… Encrypted - Key ID: {key_id}")

# Decrypt (while key exists)
decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)
print(f"âœ… Decrypted: {decrypted_data.decode()}")

# Shred key (data becomes irrecoverable)
shredder.shred_key(key_id)

# Try to decrypt after shredding
decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)
print(f"âŒ Decryption after shred: {decrypted_data}")  # None
```

## Retention policies

iLuminara supports four retention policies aligned with global frameworks:

| Policy | Duration | Description | Compliance |
|--------|----------|-------------|------------|
| **HOT** | 180 days | Active operational data | KDPA, POPIA |
| **WARM** | 365 days | Compliance minimum | HIPAA Â§164.530(j) |
| **COLD** | 1825 days | Legal hold maximum | GDPR Art. 17 |
| **ETERNAL** | Never | Requires explicit justification | Special cases only |

```python
from governance_kernel.crypto_shredder import RetentionPolicy

# Hot storage (6 months)
encrypted, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT
)

# Warm storage (1 year)
encrypted, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.WARM
)

# Cold storage (5 years)
encrypted, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.COLD
)
```

## Sovereignty zones

Data residency is enforced through sovereignty zones:

```python
from governance_kernel.crypto_shredder import SovereigntyZone

# Kenya (KDPA jurisdiction)
shredder_ke = CryptoShredder(sovereignty_zone=SovereigntyZone.KENYA)

# EU (GDPR jurisdiction)
shredder_eu = CryptoShredder(sovereignty_zone=SovereigntyZone.EU)

# South Africa (POPIA jurisdiction)
shredder_za = CryptoShredder(sovereignty_zone=SovereigntyZone.SOUTH_AFRICA)

# Canada (PIPEDA jurisdiction)
shredder_ca = CryptoShredder(sovereignty_zone=SovereigntyZone.CANADA)

# USA (HIPAA jurisdiction)
shredder_us = CryptoShredder(sovereignty_zone=SovereigntyZone.USA)
```

## Auto-shred expired keys

Automatically shred all expired keys:

```python
# Run auto-shred
shredded_count = shredder.auto_shred_expired_keys()
print(f"ðŸ”¥ Auto-shred complete - {shredded_count} keys shredded")
```

**Recommended schedule:**
- **Daily at 2 AM UTC** - Automated via cron or Cloud Scheduler
- **Before backups** - Ensure expired keys are shredded before backup
- **After retention audits** - Clean up after compliance reviews

## Key status tracking

Check the status of any key:

```python
status = shredder.get_key_status(key_id)

print(f"Key ID: {status['key_id']}")
print(f"Created: {status['created_at']}")
print(f"Expires: {status['expires_at']}")
print(f"Retention Policy: {status['retention_policy']}")
print(f"Sovereignty Zone: {status['sovereignty_zone']}")
print(f"Shredded: {status['shredded']}")

if status['shredded']:
    print(f"Shredded At: {status['shredded_at']}")
```

## Audit trail

Every crypto operation is logged for compliance:

```python
# Enable audit logging
shredder = CryptoShredder(enable_audit=True)

# All operations are automatically logged:
# - ENCRYPT: When data is encrypted
# - DECRYPT: When data is decrypted
# - SHRED: When key is shredded
# - DECRYPT_FAILED_SHREDDED: When decryption fails due to shredded key

# View audit log
for entry in shredder.audit_log:
    print(f"{entry['timestamp']} - {entry['action']} - {entry['key_id']}")
```

**Audit log location:** `./keys/audit.jsonl`

## Compliance mapping

Crypto Shredder satisfies multiple compliance requirements:

### GDPR Art. 17 (Right to Erasure)

> "The data subject shall have the right to obtain from the controller the erasure of personal data..."

**Crypto Shredder compliance:**
- Key shredding makes data cryptographically irrecoverable
- Audit trail proves when data became inaccessible
- No need to track down all copies (encrypted data is useless without key)

### HIPAA Â§164.530(j) (Documentation)

> "Retain documentation for 6 years from the date of its creation or the date when it last was in effect, whichever is later."

**Crypto Shredder compliance:**
- WARM retention policy (365 days) exceeds minimum
- Audit trail retained separately for 7 years
- Key metadata preserved even after shredding

### NIST SP 800-88 (Media Sanitization)

> "Clear, Purge, or Destroy media to prevent data recovery."

**Crypto Shredder compliance:**
- Key overwrite follows DoD 5220.22-M standard
- Cryptographic erasure is equivalent to physical destruction
- Verifiable through audit trail

### ISO 27001 A.8.3.2 (Disposal of Media)

> "Media shall be disposed of securely when no longer required."

**Crypto Shredder compliance:**
- Ephemeral keys are "media" that gets disposed
- Shredding process is auditable and verifiable
- Encrypted data can remain indefinitely (no disposal needed)

## Integration with SovereignGuardrail

Crypto Shredder integrates seamlessly with the governance kernel:

```python
from governance_kernel.vector_ledger import SovereignGuardrail
from governance_kernel.crypto_shredder import CryptoShredder

guardrail = SovereignGuardrail()
shredder = CryptoShredder()

# Validate before encryption
guardrail.validate_action(
    action_type='Data_Retention',
    payload={
        'data_type': 'PHI',
        'retention_policy': 'HOT',
        'record_date': '2025-01-15'
    },
    jurisdiction='GDPR_EU'
)

# Encrypt with validated policy
encrypted, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT
)
```

## Performance

- **Encryption**: ~1ms per record (AES-256-GCM)
- **Decryption**: ~1ms per record
- **Key shredding**: ~10ms per key (includes audit logging)
- **Auto-shred**: ~100 keys/second

## Security considerations

<AccordionGroup>
  <Accordion title="Key storage">
    Keys are stored in `./keys/` directory. In production, use Cloud KMS or Hardware Security Module (HSM).
  </Accordion>
  <Accordion title="Key rotation">
    Each data record gets a unique ephemeral key. No key rotation needed.
  </Accordion>
  <Accordion title="Backup strategy">
    Encrypted data can be backed up freely. Keys should NOT be backed up (defeats the purpose).
  </Accordion>
  <Accordion title="Disaster recovery">
    If keys are lost, data is irrecoverable. This is by design. Plan accordingly.
  </Accordion>
</AccordionGroup>

## Production deployment

### Cloud KMS integration

```python
from google.cloud import kms

class CloudKMSShredder(CryptoShredder):
    def __init__(self, project_id, location, key_ring, key_name):
        super().__init__()
        self.kms_client = kms.KeyManagementServiceClient()
        self.key_path = self.kms_client.crypto_key_path(
            project_id, location, key_ring, key_name
        )
    
    def encrypt_with_ephemeral_key(self, data, retention_policy, metadata):
        # Use Cloud KMS for key encryption
        # Store encrypted key in Cloud Spanner
        # Return encrypted data
        pass
```

### Automated shredding

```yaml
# Cloud Scheduler job
name: crypto-shredder-auto-shred
schedule: "0 2 * * *"  # Daily at 2 AM UTC
target:
  uri: https://api.iluminara.health/admin/auto-shred
  httpMethod: POST
```

## Next steps

<CardGroup cols={2}>
  <Card
    title="SovereignGuardrail"
    icon="shield-check"
    href="/governance/overview"
  >
    Integrate with compliance enforcement
  </Card>
  <Card
    title="Security stack"
    icon="shield-halved"
    href="/security/overview"
  >
    Complete security architecture
  </Card>
  <Card
    title="Deployment"
    icon="rocket"
    href="/deployment/overview"
  >
    Deploy to production
  </Card>
  <Card
    title="API reference"
    icon="code"
    href="/api-reference/overview"
  >
    REST API integration
  </Card>
</CardGroup>
