---
title: Crypto Shredder (IP-02)
description: Data is not deleted; it is cryptographically dissolved
---

## Overview

IP-02 Crypto Shredder implements a revolutionary approach to data deletion: instead of attempting to securely erase data, we encrypt it with ephemeral keys and then shred the keys after the retention period.

<Card
  title="Philosophy"
  icon="fire"
>
  "Data is not deleted; it is cryptographically dissolved."
</Card>

## Why Crypto Shredder?

Traditional data deletion is problematic:

- **Incomplete deletion** - Data remnants persist on disk
- **Backup complications** - Deleted data remains in backups
- **Compliance challenges** - Hard to prove deletion occurred
- **Performance impact** - Secure deletion is slow

Crypto Shredder solves all of these:

âœ… **Cryptographic guarantee** - Data is mathematically irrecoverable  
âœ… **Backup-safe** - Encrypted data in backups is useless without key  
âœ… **Audit-friendly** - Key shredding is logged and verifiable  
âœ… **High performance** - Key deletion is instant  

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA LIFECYCLE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. ENCRYPT
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Plain Data  â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ AES-256-GCM
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Encrypted    â”‚â”€â”€â”€â”€â–¶â”‚ Ephemeral    â”‚
   â”‚ Data         â”‚     â”‚ Key (stored) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. RETENTION PERIOD (HOT: 180 days, WARM: 365 days, COLD: 1825 days)
   
3. SHRED KEY
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Ephemeral    â”‚
   â”‚ Key          â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ Overwrite with random data
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Shredded Key â”‚
   â”‚ (irrecoverable)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. DATA DISSOLVED
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Encrypted    â”‚  â† Cryptographically irrecoverable
   â”‚ Data         â”‚     (no key exists)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Retention policies

```python
from governance_kernel.crypto_shredder import RetentionPolicy

class RetentionPolicy(Enum):
    HOT = 180      # 6 months - Active operational data
    WARM = 365     # 1 year - Compliance minimum (HIPAA)
    COLD = 1825    # 5 years - Legal hold maximum (GDPR Art. 17)
    ETERNAL = -1   # Never expires (requires explicit justification)
```

## Basic usage

### Encrypt data

```python
from governance_kernel.crypto_shredder import CryptoShredder, RetentionPolicy, SovereigntyZone

# Initialize Crypto Shredder
shredder = CryptoShredder(
    key_storage_path="./keys",
    sovereignty_zone=SovereigntyZone.KENYA,
    enable_audit=True
)

# Encrypt patient data
patient_data = b"Patient ID: 12345, Diagnosis: Malaria, Location: Dadaab"

encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT,
    metadata={
        "patient_id": "12345",
        "jurisdiction": "KDPA_KE",
        "data_type": "PHI"
    }
)

print(f"âœ… Encrypted - Key ID: {key_id}")
```

### Decrypt data

```python
# Decrypt (while key exists)
decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)

if decrypted_data:
    print(f"âœ… Decrypted: {decrypted_data.decode()}")
else:
    print("âŒ Decryption failed - Key may be shredded")
```

### Shred key

```python
# Shred key (data becomes irrecoverable)
shredder.shred_key(key_id)

# Try to decrypt after shredding
decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)
print(f"Result: {decrypted_data}")  # None - cryptographically irrecoverable
```

## Auto-shred expired keys

```python
# Automatically shred all expired keys
shredded_count = shredder.auto_shred_expired_keys()

print(f"ğŸ”¥ Auto-shred complete - {shredded_count} keys shredded")
```

**Recommended:** Run this daily via cron:

```bash
# Add to crontab
0 2 * * * python -c "from governance_kernel.crypto_shredder import CryptoShredder; CryptoShredder().auto_shred_expired_keys()"
```

## Key metadata

Each key stores metadata for audit and compliance:

```python
# Get key status
status = shredder.get_key_status(key_id)

print(status)
```

**Output:**

```json
{
  "key_id": "a3f5c8d2e1b4f7a9",
  "created_at": "2025-01-15T10:00:00.000Z",
  "expires_at": "2025-07-14T10:00:00.000Z",
  "retention_policy": "HOT",
  "sovereignty_zone": "africa-south1",
  "metadata": {
    "patient_id": "12345",
    "jurisdiction": "KDPA_KE",
    "data_type": "PHI"
  },
  "shredded": false
}
```

## Sovereignty zones

Data residency is enforced at the key level:

```python
class SovereigntyZone(Enum):
    EU = "eu-west1"              # GDPR jurisdiction
    KENYA = "africa-south1"      # KDPA jurisdiction
    SOUTH_AFRICA = "africa-south1"  # POPIA jurisdiction
    CANADA = "northamerica-northeast1"  # PIPEDA jurisdiction
    USA = "us-central1"          # HIPAA jurisdiction
```

## Audit trail

All Crypto Shredder operations are logged:

```python
# View audit log
for entry in shredder.audit_log:
    print(f"{entry['timestamp']} - {entry['action']} - {entry['key_id']}")
```

**Audit events:**
- `ENCRYPT` - Data encrypted with ephemeral key
- `DECRYPT` - Data decrypted successfully
- `DECRYPT_FAILED_SHREDDED` - Decryption failed (key shredded)
- `SHRED` - Key shredded (data dissolved)

## Compliance mapping

| Framework | Requirement | Crypto Shredder Implementation |
|-----------|-------------|-------------------------------|
| **GDPR Art. 17** | Right to Erasure | Key shredding = cryptographic erasure |
| **HIPAA Â§164.530(j)** | Documentation | Tamper-proof audit trail |
| **NIST SP 800-88** | Media Sanitization | DoD 5220.22-M key overwrite |
| **ISO 27001 A.8.3.2** | Disposal of Media | Cryptographic dissolution |
| **CCPA Â§1798.105** | Right to Delete | Key shredding on request |

## Integration with SovereignGuardrail

```python
from governance_kernel.vector_ledger import SovereignGuardrail
from governance_kernel.crypto_shredder import CryptoShredder, RetentionPolicy

# Initialize both
guardrail = SovereignGuardrail()
shredder = CryptoShredder()

# Encrypt with sovereignty validation
guardrail.validate_action(
    action_type='Data_Processing',
    payload={
        'data_type': 'PHI',
        'processing_location': 'Edge_Node',
        'retention_policy': 'HOT'
    },
    jurisdiction='KDPA_KE'
)

encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT
)
```

## Advanced: Custom retention policies

```python
from datetime import datetime, timedelta

# Create custom retention
custom_expiration = datetime.utcnow() + timedelta(days=90)

# Manually set expiration
key_metadata = shredder.get_key_status(key_id)
key_metadata['expires_at'] = custom_expiration.isoformat()

# Save updated metadata
# (Implementation detail - modify key file directly)
```

## Performance

- **Encryption**: ~1ms per record (AES-256-GCM)
- **Decryption**: ~1ms per record
- **Key shredding**: <1ms (instant)
- **Auto-shred**: ~100ms per 1000 keys

## Security guarantees

<AccordionGroup>
  <Accordion title="Cryptographic strength">
    AES-256-GCM with 256-bit keys. Brute force would take 2^256 operations (longer than age of universe).
  </Accordion>
  <Accordion title="Key storage">
    Keys stored on disk with filesystem permissions. For production, use Cloud KMS or HSM.
  </Accordion>
  <Accordion title="Key shredding">
    DoD 5220.22-M standard: overwrite with random data before deletion.
  </Accordion>
  <Accordion title="Backup safety">
    Encrypted data in backups is useless without keys. Shredded keys cannot be recovered from backups.
  </Accordion>
</AccordionGroup>

## Production deployment

### Use Cloud KMS for key storage

```python
from google.cloud import kms

# Store keys in Cloud KMS instead of filesystem
# (Implementation detail - integrate with Cloud KMS API)
```

### Enable tamper-proof audit

```python
shredder = CryptoShredder(
    enable_audit=True,
    audit_backend="Cloud_Spanner"  # Tamper-proof storage
)
```

### Configure auto-shred schedule

```yaml
# config/sovereign_guardrail.yaml
retention:
  auto_shred_enabled: true
  auto_shred_schedule: "0 2 * * *"  # Daily at 2 AM UTC
```

## Testing

```python
# Test encryption/decryption cycle
def test_crypto_shredder():
    shredder = CryptoShredder()
    
    # Encrypt
    data = b"Test data"
    encrypted, key_id = shredder.encrypt_with_ephemeral_key(
        data=data,
        retention_policy=RetentionPolicy.HOT
    )
    
    # Decrypt
    decrypted = shredder.decrypt_with_key(encrypted, key_id)
    assert decrypted == data
    
    # Shred
    shredder.shred_key(key_id)
    
    # Verify irrecoverable
    decrypted = shredder.decrypt_with_key(encrypted, key_id)
    assert decrypted is None
    
    print("âœ… Crypto Shredder test passed")

test_crypto_shredder()
```

## Next steps

<CardGroup cols={2}>
  <Card
    title="SovereignGuardrail"
    icon="shield-check"
    href="/governance/overview"
  >
    Integrate with compliance enforcement
  </Card>
  <Card
    title="Retention policies"
    icon="clock"
    href="/governance/retention"
  >
    Configure data retention rules
  </Card>
  <Card
    title="Audit trail"
    icon="file-contract"
    href="/governance/audit"
  >
    Set up tamper-proof logging
  </Card>
  <Card
    title="Cloud KMS"
    icon="key"
    href="/deployment/kms"
  >
    Production key management
  </Card>
</CardGroup>
