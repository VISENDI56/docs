---
title: Crypto Shredder (IP-02)
description: Data is not deleted; it is cryptographically dissolved
---

## Overview

IP-02 Crypto Shredder implements a revolutionary approach to data deletion: instead of removing data, we encrypt it with ephemeral keys and then **shred the keys**, making the data cryptographically irrecoverable.

<Card
  title="Philosophy"
  icon="fire"
>
  "Data is not deleted; it is cryptographically dissolved."
</Card>

## Why Crypto Shredder?

Traditional data deletion has fundamental problems:

<AccordionGroup>
  <Accordion title="Problem 1: Deletion is never complete">
    Data persists in backups, logs, caches, and replicas. True deletion is impossible in distributed systems.
  </Accordion>
  <Accordion title="Problem 2: Compliance requires proof">
    GDPR Art. 17 requires proof of deletion. How do you prove something no longer exists?
  </Accordion>
  <Accordion title="Problem 3: Recovery is often possible">
    Deleted data can be recovered from disk sectors, memory dumps, and forensic analysis.
  </Accordion>
</AccordionGroup>

## The Crypto Shredder solution

Instead of deleting data:

<Steps>
  <Step title="Encrypt with ephemeral key">
    Data is encrypted with a randomly generated 256-bit AES key
  </Step>
  <Step title="Store encrypted data">
    Encrypted data remains in storage (backups, replicas work normally)
  </Step>
  <Step title="Shred the key">
    After retention period, the key is cryptographically overwritten (DoD 5220.22-M standard)
  </Step>
  <Step title="Data becomes irrecoverable">
    Without the key, encrypted data is mathematically impossible to decrypt
  </Step>
</Steps>

## Basic usage

```python
from governance_kernel.crypto_shredder import CryptoShredder, RetentionPolicy, SovereigntyZone

# Initialize Crypto Shredder
shredder = CryptoShredder(
    key_storage_path="./keys",
    sovereignty_zone=SovereigntyZone.KENYA,
    enable_audit=True
)

# Encrypt patient data
patient_data = b"Patient ID: 12345, Diagnosis: Malaria, Location: Dadaab"
encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT,
    metadata={
        "patient_id": "12345",
        "jurisdiction": "KDPA_KE",
        "data_type": "PHI"
    }
)

print(f"âœ… Encrypted - Key ID: {key_id}")

# Decrypt (while key exists)
decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)
print(f"âœ… Decrypted: {decrypted_data.decode()}")

# Shred key (data becomes irrecoverable)
shredder.shred_key(key_id)

# Try to decrypt after shredding
decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)
print(f"âŒ Decryption after shred: {decrypted_data}")  # None
```

## Retention policies

Crypto Shredder supports multiple retention policies aligned with global frameworks:

| Policy | Duration | Use Case | Compliance |
|--------|----------|----------|------------|
| **HOT** | 180 days | Active operational data | Standard practice |
| **WARM** | 365 days | Compliance minimum | HIPAA Â§164.530(j) |
| **COLD** | 1825 days | Legal hold maximum | GDPR Art. 17 |
| **ETERNAL** | Never expires | Requires explicit justification | Special cases only |

```python
# Different retention policies
encrypted_hot, key_hot = shredder.encrypt_with_ephemeral_key(
    data=operational_data,
    retention_policy=RetentionPolicy.HOT  # 180 days
)

encrypted_warm, key_warm = shredder.encrypt_with_ephemeral_key(
    data=compliance_data,
    retention_policy=RetentionPolicy.WARM  # 365 days
)

encrypted_cold, key_cold = shredder.encrypt_with_ephemeral_key(
    data=legal_hold_data,
    retention_policy=RetentionPolicy.COLD  # 1825 days (5 years)
)
```

## Sovereignty zones

Data residency is enforced through sovereignty zones:

```python
class SovereigntyZone(Enum):
    EU = "eu-west1"              # GDPR jurisdiction
    KENYA = "africa-south1"      # KDPA jurisdiction
    SOUTH_AFRICA = "africa-south1"  # POPIA jurisdiction
    CANADA = "northamerica-northeast1"  # PIPEDA jurisdiction
    USA = "us-central1"          # HIPAA jurisdiction
```

Each encrypted record is tagged with its sovereignty zone:

```python
shredder_kenya = CryptoShredder(sovereignty_zone=SovereigntyZone.KENYA)
shredder_eu = CryptoShredder(sovereignty_zone=SovereigntyZone.EU)

# Data encrypted in Kenya stays in Kenya
encrypted_ke, key_ke = shredder_kenya.encrypt_with_ephemeral_key(
    data=kenyan_patient_data,
    retention_policy=RetentionPolicy.HOT
)
```

## Auto-shredding

Crypto Shredder automatically shreds expired keys:

```python
# Run daily (e.g., via cron job)
shredded_count = shredder.auto_shred_expired_keys()
print(f"ğŸ”¥ Auto-shred complete - {shredded_count} keys shredded")
```

**Recommended schedule:** Daily at 2 AM UTC

```bash
# Crontab entry
0 2 * * * /usr/bin/python3 /path/to/auto_shred.py
```

## Key lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    KEY LIFECYCLE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. CREATION
   â”œâ”€ Generate 256-bit random key
   â”œâ”€ Encrypt data with AES-256-GCM
   â”œâ”€ Store key with metadata
   â””â”€ Set expiration based on retention policy

2. ACTIVE (Before Expiration)
   â”œâ”€ Key available for decryption
   â”œâ”€ Data can be accessed
   â””â”€ Audit trail records all access

3. EXPIRED (After Retention Period)
   â”œâ”€ Auto-shred triggered
   â”œâ”€ Key overwritten with random data (DoD 5220.22-M)
   â”œâ”€ Metadata marked as "shredded"
   â””â”€ Data becomes cryptographically irrecoverable

4. SHREDDED (Permanent)
   â”œâ”€ Key material destroyed
   â”œâ”€ Decryption impossible
   â”œâ”€ Encrypted data remains (but useless)
   â””â”€ Audit trail preserved
```

## Audit trail

Every Crypto Shredder operation is logged:

```python
# Enable audit logging
shredder = CryptoShredder(enable_audit=True)

# All operations are logged
encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(...)  # Logged
decrypted_data = shredder.decrypt_with_key(...)  # Logged
shredder.shred_key(key_id)  # Logged

# View audit log
audit_path = "./keys/audit.jsonl"
with open(audit_path, 'r') as f:
    for line in f:
        print(json.loads(line))
```

**Audit log format:**

```json
{
  "timestamp": "2025-12-23T14:00:00.000Z",
  "action": "ENCRYPT",
  "key_id": "a1b2c3d4e5f6g7h8",
  "sovereignty_zone": "africa-south1",
  "metadata": {
    "patient_id": "12345",
    "jurisdiction": "KDPA_KE",
    "data_type": "PHI"
  }
}
```

## Key status

Check the status of any key:

```python
status = shredder.get_key_status(key_id)

print(f"Key ID: {status['key_id']}")
print(f"Created: {status['created_at']}")
print(f"Expires: {status['expires_at']}")
print(f"Retention Policy: {status['retention_policy']}")
print(f"Sovereignty Zone: {status['sovereignty_zone']}")
print(f"Shredded: {status['shredded']}")

if status['shredded']:
    print(f"Shredded At: {status['shredded_at']}")
```

## Compliance mapping

| Framework | Requirement | Crypto Shredder Implementation |
|-----------|-------------|-------------------------------|
| **GDPR Art. 17** | Right to Erasure | Key shredding = cryptographic erasure |
| **HIPAA Â§164.530(j)** | Documentation | Audit trail of all operations |
| **NIST SP 800-88** | Media Sanitization | DoD 5220.22-M key overwriting |
| **ISO 27001 A.8.3.2** | Disposal of Media | Cryptographic dissolution |
| **POPIA Â§14** | Data Retention | Retention policies enforced |

## Integration with API

```python
from flask import Flask, request
from governance_kernel.crypto_shredder import CryptoShredder, RetentionPolicy

app = Flask(__name__)
shredder = CryptoShredder(sovereignty_zone=SovereigntyZone.KENYA)

@app.route('/store-patient-data', methods=['POST'])
def store_patient_data():
    patient_data = request.json
    
    # Encrypt before storing
    encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
        data=json.dumps(patient_data).encode(),
        retention_policy=RetentionPolicy.HOT,
        metadata={
            "patient_id": patient_data['id'],
            "jurisdiction": "KDPA_KE"
        }
    )
    
    # Store encrypted_data in database
    db.store(key_id, encrypted_data)
    
    return {"key_id": key_id}

@app.route('/retrieve-patient-data/<key_id>', methods=['GET'])
def retrieve_patient_data(key_id):
    # Retrieve encrypted data
    encrypted_data = db.retrieve(key_id)
    
    # Decrypt
    decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)
    
    if decrypted_data is None:
        return {"error": "Data shredded or key expired"}, 404
    
    return json.loads(decrypted_data.decode())
```

## Performance

- **Encryption**: ~1ms per record (AES-256-GCM)
- **Decryption**: ~1ms per record
- **Key shredding**: ~10ms per key (DoD overwriting)
- **Auto-shred**: ~100 keys/second

## Security guarantees

<CardGroup cols={2}>
  <Card title="AES-256-GCM" icon="lock">
    Military-grade encryption with authenticated encryption
  </Card>
  <Card title="Random key generation" icon="dice">
    Cryptographically secure random number generator
  </Card>
  <Card title="DoD 5220.22-M" icon="shield-halved">
    Department of Defense standard for key overwriting
  </Card>
  <Card title="Tamper-proof audit" icon="file-contract">
    Complete audit trail of all operations
  </Card>
</CardGroup>

## Best practices

<Steps>
  <Step title="Use appropriate retention policies">
    Don't use ETERNAL unless absolutely necessary
  </Step>
  <Step title="Enable audit logging">
    Always enable audit for compliance
  </Step>
  <Step title="Run auto-shred daily">
    Set up cron job for automatic key expiration
  </Step>
  <Step title="Monitor key lifecycle">
    Track key creation, access, and shredding metrics
  </Step>
  <Step title="Test recovery scenarios">
    Verify that shredded data is truly irrecoverable
  </Step>
</Steps>

## Next steps

<CardGroup cols={2}>
  <Card
    title="SovereignGuardrail"
    icon="shield-check"
    href="/governance/overview"
  >
    Integrate with compliance enforcement
  </Card>
  <Card
    title="Security overview"
    icon="shield-halved"
    href="/security/overview"
  >
    Complete security stack documentation
  </Card>
  <Card
    title="API integration"
    icon="terminal"
    href="/api-reference/overview"
  >
    Use Crypto Shredder in your API
  </Card>
  <Card
    title="Deployment"
    icon="rocket"
    href="/deployment/overview"
  >
    Deploy to production
  </Card>
</CardGroup>
