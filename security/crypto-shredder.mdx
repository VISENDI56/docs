---
title: Crypto Shredder (IP-02)
description: Data is not deleted; it is cryptographically dissolved
---

## Overview

IP-02 Crypto Shredder implements a revolutionary approach to data deletion: instead of erasing data, we encrypt it with ephemeral keys and then **shred the keys** after the retention period, making the data cryptographically irrecoverable.

<Card
  title="Philosophy"
  icon="fire"
>
  "Data is not deleted; it is cryptographically dissolved."
</Card>

## Why Crypto Shredder?

Traditional data deletion has fundamental problems:

- **Forensic recovery** - Deleted data can often be recovered
- **Compliance ambiguity** - "Deletion" is not well-defined legally
- **Storage overhead** - Secure deletion requires multiple overwrites
- **Audit trail loss** - No proof that deletion occurred

Crypto Shredder solves all of these:

âœ… **Cryptographically irrecoverable** - No forensic recovery possible  
âœ… **Compliance-first** - Meets GDPR Art. 17 "Right to Erasure"  
âœ… **Zero overhead** - No data overwriting required  
âœ… **Tamper-proof audit** - Complete key lifecycle logging  

## How it works

<Steps>
  <Step title="Encrypt with ephemeral key">
    Data is encrypted with a randomly generated 256-bit AES key
  </Step>
  <Step title="Store encrypted data">
    Encrypted data remains in storage (no deletion needed)
  </Step>
  <Step title="Store key with expiration">
    Key is stored separately with retention policy metadata
  </Step>
  <Step title="Shred key after retention">
    Key is overwritten with random data (DoD 5220.22-M standard)
  </Step>
  <Step title="Data becomes irrecoverable">
    Without the key, encrypted data is cryptographically useless
  </Step>
</Steps>

## Basic usage

```python
from governance_kernel.crypto_shredder import CryptoShredder, RetentionPolicy, SovereigntyZone

# Initialize Crypto Shredder
shredder = CryptoShredder(
    sovereignty_zone=SovereigntyZone.KENYA,
    enable_audit=True
)

# Encrypt patient data
patient_data = b"Patient ID: 12345, Diagnosis: Malaria, Location: Dadaab"
encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT,
    metadata={
        "patient_id": "12345",
        "jurisdiction": "KDPA_KE",
        "data_type": "PHI"
    }
)

print(f"âœ… Encrypted - Key ID: {key_id}")

# Decrypt (while key exists)
decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)
print(f"âœ… Decrypted: {decrypted_data.decode()}")

# Shred key (data becomes irrecoverable)
shredder.shred_key(key_id)

# Try to decrypt after shredding
decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)
print(f"âŒ Decryption after shred: {decrypted_data}")  # None
```

## Retention policies

Crypto Shredder supports four retention policies aligned with global frameworks:

| Policy | Duration | Use Case | Compliance |
|--------|----------|----------|------------|
| **HOT** | 180 days | Active operational data | Standard operations |
| **WARM** | 365 days | Compliance minimum | HIPAA Â§164.530(j) |
| **COLD** | 1825 days | Legal hold maximum | GDPR Art. 17 |
| **ETERNAL** | Never expires | Requires explicit justification | Special cases only |

```python
from governance_kernel.crypto_shredder import RetentionPolicy

# Hot storage (6 months)
encrypted, key_id = shredder.encrypt_with_ephemeral_key(
    data=data,
    retention_policy=RetentionPolicy.HOT
)

# Warm storage (1 year)
encrypted, key_id = shredder.encrypt_with_ephemeral_key(
    data=data,
    retention_policy=RetentionPolicy.WARM
)

# Cold storage (5 years)
encrypted, key_id = shredder.encrypt_with_ephemeral_key(
    data=data,
    retention_policy=RetentionPolicy.COLD
)
```

## Sovereignty zones

Data residency is enforced through sovereignty zones:

```python
from governance_kernel.crypto_shredder import SovereigntyZone

# Kenya (KDPA jurisdiction)
shredder_ke = CryptoShredder(sovereignty_zone=SovereigntyZone.KENYA)

# EU (GDPR jurisdiction)
shredder_eu = CryptoShredder(sovereignty_zone=SovereigntyZone.EU)

# South Africa (POPIA jurisdiction)
shredder_za = CryptoShredder(sovereignty_zone=SovereigntyZone.SOUTH_AFRICA)

# Canada (PIPEDA jurisdiction)
shredder_ca = CryptoShredder(sovereignty_zone=SovereigntyZone.CANADA)

# USA (HIPAA jurisdiction)
shredder_us = CryptoShredder(sovereignty_zone=SovereigntyZone.USA)
```

## Auto-shred expired keys

Automatically shred all expired keys:

```python
# Run auto-shred
shredded_count = shredder.auto_shred_expired_keys()
print(f"ðŸ”¥ Auto-shred complete - {shredded_count} keys shredded")
```

Schedule auto-shred with cron:

```bash
# Daily at 2 AM UTC
0 2 * * * python -c "from governance_kernel.crypto_shredder import CryptoShredder; CryptoShredder().auto_shred_expired_keys()"
```

## Key status monitoring

Check the status of any key:

```python
status = shredder.get_key_status(key_id)

print(f"Key ID: {status['key_id']}")
print(f"Created: {status['created_at']}")
print(f"Expires: {status['expires_at']}")
print(f"Retention: {status['retention_policy']}")
print(f"Shredded: {status['shredded']}")
print(f"Zone: {status['sovereignty_zone']}")
```

## Audit trail

Every Crypto Shredder operation is logged:

```python
# Enable audit logging
shredder = CryptoShredder(enable_audit=True)

# All operations are automatically logged
shredder.encrypt_with_ephemeral_key(data, RetentionPolicy.HOT)
shredder.decrypt_with_key(encrypted_data, key_id)
shredder.shred_key(key_id)

# Audit log is persisted to disk
# Location: ./keys/audit.jsonl
```

Audit log format:

```json
{
  "timestamp": "2025-12-23T10:00:00.000Z",
  "action": "ENCRYPT",
  "key_id": "a1b2c3d4e5f6g7h8",
  "sovereignty_zone": "africa-south1",
  "metadata": {
    "patient_id": "12345",
    "jurisdiction": "KDPA_KE",
    "data_type": "PHI"
  }
}
```

## Compliance mapping

Crypto Shredder satisfies multiple compliance requirements:

### GDPR Art. 17 (Right to Erasure)

> "The data subject shall have the right to obtain from the controller the erasure of personal data..."

âœ… **Satisfied:** Key shredding makes data cryptographically irrecoverable, equivalent to erasure.

### HIPAA Â§164.530(j) (Documentation)

> "Retain documentation for 6 years from the date of its creation or the date when it last was in effect..."

âœ… **Satisfied:** Retention policies enforce minimum 1-year retention (WARM policy).

### NIST SP 800-88 (Media Sanitization)

> "Clear, Purge, or Destroy information from storage media..."

âœ… **Satisfied:** Key shredding uses DoD 5220.22-M overwrite standard.

### ISO 27001 A.8.3.2 (Disposal of Media)

> "Media shall be disposed of securely when no longer required..."

âœ… **Satisfied:** Ephemeral keys are securely shredded after retention period.

## Integration with SovereignGuardrail

Crypto Shredder integrates seamlessly with the Governance Kernel:

```python
from governance_kernel.vector_ledger import SovereignGuardrail
from governance_kernel.crypto_shredder import CryptoShredder, RetentionPolicy

guardrail = SovereignGuardrail()
shredder = CryptoShredder()

# Validate before encryption
guardrail.validate_action(
    action_type='Data_Processing',
    payload={
        'data_type': 'PHI',
        'processing_location': 'Edge_Node',
        'consent_token': 'VALID_TOKEN'
    },
    jurisdiction='KDPA_KE'
)

# Encrypt with Crypto Shredder
encrypted, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT
)
```

## Performance

- **Encryption**: ~1ms per record (AES-256-GCM)
- **Decryption**: ~1ms per record
- **Key shredding**: ~5ms per key (DoD overwrite)
- **Auto-shred**: ~100 keys/second

## Security guarantees

<AccordionGroup>
  <Accordion title="Cryptographic strength">
    AES-256-GCM with 256-bit keys (NIST approved, FIPS 140-2 compliant)
  </Accordion>
  <Accordion title="Key randomness">
    Keys generated using `secrets.token_bytes()` (cryptographically secure PRNG)
  </Accordion>
  <Accordion title="Shredding standard">
    DoD 5220.22-M overwrite standard (3-pass random overwrite)
  </Accordion>
  <Accordion title="Audit integrity">
    Tamper-proof audit trail with SHA-256 hash chain
  </Accordion>
</AccordionGroup>

## Next steps

<CardGroup cols={2}>
  <Card
    title="SovereignGuardrail"
    icon="shield-check"
    href="/governance/overview"
  >
    Integrate with compliance enforcement
  </Card>
  <Card
    title="Retention policies"
    icon="clock"
    href="/governance/retention"
  >
    Configure data retention rules
  </Card>
  <Card
    title="Audit trail"
    icon="file-contract"
    href="/governance/audit"
  >
    Set up tamper-proof logging
  </Card>
  <Card
    title="Security stack"
    icon="shield-halved"
    href="/security/overview"
  >
    Complete security architecture
  </Card>
</CardGroup>
