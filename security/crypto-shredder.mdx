---
title: Crypto Shredder (IP-02)
description: Data is not deleted; it is cryptographically dissolved
---

## Overview

IP-02 Crypto Shredder implements a revolutionary approach to data deletion: instead of deleting data, we encrypt it with ephemeral keys and then **shred the keys** after the retention period, making the data cryptographically irrecoverable.

<Card
  title="Philosophy"
  icon="fire"
>
  "Data is not deleted. It is cryptographically dissolved."
</Card>

## The problem with deletion

Traditional data deletion has fundamental flaws:

<AccordionGroup>
  <Accordion title="Deletion is not guaranteed">
    File systems mark blocks as "deleted" but data remains on disk until overwritten
  </Accordion>
  <Accordion title="Backups persist">
    Deleted data may still exist in backups, snapshots, or replicas
  </Accordion>
  <Accordion title="Compliance gaps">
    GDPR "Right to Erasure" requires proof of deletion, which is hard to verify
  </Accordion>
  <Accordion title="Recovery is possible">
    Forensic tools can recover "deleted" data from disk
  </Accordion>
</AccordionGroup>

## The Crypto Shredder solution

Instead of deleting data:

<Steps>
  <Step title="Encrypt with ephemeral key">
    Data is encrypted with a unique 256-bit AES key
  </Step>
  <Step title="Store encrypted data">
    Encrypted data remains on disk (no deletion needed)
  </Step>
  <Step title="Shred the key">
    After retention period, the key is cryptographically overwritten
  </Step>
  <Step title="Data is irrecoverable">
    Without the key, encrypted data is mathematically unbreakable
  </Step>
</Steps>

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PLAINTEXT DATA                         â”‚
â”‚  Patient ID: 12345, Diagnosis: Malaria                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              EPHEMERAL KEY GENERATION                   â”‚
â”‚  Key: 256-bit AES (secrets.token_bytes(32))           â”‚
â”‚  IV: 128-bit random                                    â”‚
â”‚  Key ID: SHA-256 hash (first 16 chars)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AES-256-GCM ENCRYPTION                     â”‚
â”‚  Encrypted: IV + Tag + Ciphertext                      â”‚
â”‚  Authenticated encryption (prevents tampering)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              KEY STORAGE (with metadata)                â”‚
â”‚  {                                                      â”‚
â”‚    "key_id": "a3f2c1b9",                               â”‚
â”‚    "key": "hex_encoded_key",                           â”‚
â”‚    "expires_at": "2025-06-23T00:00:00Z",              â”‚
â”‚    "retention_policy": "HOT",                          â”‚
â”‚    "sovereignty_zone": "KENYA"                         â”‚
â”‚  }                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼
                  [RETENTION PERIOD]
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              KEY SHREDDING (DoD 5220.22-M)             â”‚
â”‚  1. Overwrite key with random data                     â”‚
â”‚  2. Overwrite IV with random data                      â”‚
â”‚  3. Overwrite tag with random data                     â”‚
â”‚  4. Mark as "shredded" in metadata                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DATA IS IRRECOVERABLE                      â”‚
â”‚  Encrypted data remains but key is gone                â”‚
â”‚  Mathematically unbreakable (2^256 keyspace)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Basic usage

```python
from governance_kernel.crypto_shredder import CryptoShredder, RetentionPolicy, SovereigntyZone

# Initialize Crypto Shredder
shredder = CryptoShredder(
    key_storage_path="./keys",
    sovereignty_zone=SovereigntyZone.KENYA,
    enable_audit=True
)

# Encrypt patient data
patient_data = b"Patient ID: 12345, Diagnosis: Malaria, Location: Dadaab"

encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT,  # 180 days
    metadata={
        "patient_id": "12345",
        "jurisdiction": "KDPA_KE",
        "data_type": "PHI"
    }
)

print(f"âœ… Encrypted - Key ID: {key_id}")

# Decrypt (while key exists)
decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)
print(f"âœ… Decrypted: {decrypted_data.decode()}")

# Shred key (data becomes irrecoverable)
shredder.shred_key(key_id)

# Try to decrypt after shredding
decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)
print(f"âŒ Decryption after shred: {decrypted_data}")  # None
```

## Retention policies

iLuminara supports four retention policies aligned with global compliance frameworks:

| Policy | Duration | Description | Compliance |
|--------|----------|-------------|------------|
| **HOT** | 180 days | Active operational data | GDPR Art. 17 |
| **WARM** | 365 days | Compliance minimum | HIPAA Â§164.530(j) |
| **COLD** | 1825 days | Legal hold maximum (5 years) | GDPR Art. 17 |
| **ETERNAL** | Never | Requires explicit justification | Special cases only |

```python
from governance_kernel.crypto_shredder import RetentionPolicy

# HOT: 6 months (active operations)
encrypted, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT
)

# WARM: 1 year (HIPAA minimum)
encrypted, key_id = shredder.encrypt_with_ephemeral_key(
    data=audit_log,
    retention_policy=RetentionPolicy.WARM
)

# COLD: 5 years (legal hold)
encrypted, key_id = shredder.encrypt_with_ephemeral_key(
    data=legal_record,
    retention_policy=RetentionPolicy.COLD
)
```

## Sovereignty zones

Data residency is enforced through sovereignty zones:

```python
from governance_kernel.crypto_shredder import SovereigntyZone

# Kenya (KDPA jurisdiction)
shredder_ke = CryptoShredder(sovereignty_zone=SovereigntyZone.KENYA)

# European Union (GDPR jurisdiction)
shredder_eu = CryptoShredder(sovereignty_zone=SovereigntyZone.EU)

# South Africa (POPIA jurisdiction)
shredder_za = CryptoShredder(sovereignty_zone=SovereigntyZone.SOUTH_AFRICA)

# Canada (PIPEDA jurisdiction)
shredder_ca = CryptoShredder(sovereignty_zone=SovereigntyZone.CANADA)

# USA (HIPAA jurisdiction)
shredder_us = CryptoShredder(sovereignty_zone=SovereigntyZone.USA)
```

## Auto-shred expired keys

Automatically shred all expired keys:

```python
# Run auto-shred (typically in cron job)
shredded_count = shredder.auto_shred_expired_keys()
print(f"ğŸ”¥ Auto-shred complete - {shredded_count} keys shredded")
```

### Cron job setup

```bash
# Add to crontab
0 2 * * * /usr/bin/python3 /path/to/auto_shred.py
```

```python
# auto_shred.py
from governance_kernel.crypto_shredder import CryptoShredder, SovereigntyZone

shredder = CryptoShredder(
    sovereignty_zone=SovereigntyZone.KENYA,
    enable_audit=True
)

shredded_count = shredder.auto_shred_expired_keys()
print(f"ğŸ”¥ {shredded_count} keys shredded")
```

## Key status monitoring

Check the status of any key:

```python
status = shredder.get_key_status(key_id)

print(f"Key ID: {status['key_id']}")
print(f"Created: {status['created_at']}")
print(f"Expires: {status['expires_at']}")
print(f"Retention Policy: {status['retention_policy']}")
print(f"Sovereignty Zone: {status['sovereignty_zone']}")
print(f"Shredded: {status['shredded']}")

if status['shredded']:
    print(f"Shredded At: {status['shredded_at']}")
```

## Audit trail

Every Crypto Shredder operation is logged to a tamper-proof audit trail:

```python
# View audit log
for entry in shredder.audit_log:
    print(f"{entry['timestamp']} - {entry['action']} - {entry['key_id']}")

# Audit log is also persisted to disk
# ./keys/audit.jsonl
```

### Audit events

- `ENCRYPT` - Data encrypted with ephemeral key
- `DECRYPT` - Data decrypted successfully
- `DECRYPT_FAILED_SHREDDED` - Decryption failed (key shredded)
- `SHRED` - Key shredded (data irrecoverable)

## Compliance mapping

| Framework | Requirement | Crypto Shredder Implementation |
|-----------|-------------|-------------------------------|
| **GDPR Art. 17** | Right to Erasure | Key shredding = cryptographic erasure |
| **HIPAA Â§164.530(j)** | Documentation | Audit trail with retention metadata |
| **NIST SP 800-88** | Media Sanitization | DoD 5220.22-M key overwriting |
| **ISO 27001 A.8.3.2** | Disposal of Media | Cryptographic dissolution |
| **POPIA Â§14** | Data Retention | Retention policies enforced |

## Security guarantees

<AccordionGroup>
  <Accordion title="AES-256-GCM encryption">
    Industry-standard authenticated encryption with 256-bit keys
  </Accordion>
  <Accordion title="Unique keys per record">
    Each record has its own ephemeral key (no key reuse)
  </Accordion>
  <Accordion title="DoD 5220.22-M shredding">
    Keys overwritten with random data per DoD standard
  </Accordion>
  <Accordion title="Mathematically unbreakable">
    2^256 keyspace = 10^77 possible keys (more than atoms in universe)
  </Accordion>
  <Accordion title="Tamper-proof audit">
    All operations logged with cryptographic signatures
  </Accordion>
</AccordionGroup>

## Integration with SovereignGuardrail

Crypto Shredder integrates with the Governance Kernel:

```python
from governance_kernel.vector_ledger import SovereignGuardrail
from governance_kernel.crypto_shredder import CryptoShredder, RetentionPolicy

guardrail = SovereignGuardrail()
shredder = CryptoShredder()

# Encrypt data
encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_record,
    retention_policy=RetentionPolicy.HOT,
    metadata={"patient_id": "12345", "jurisdiction": "KDPA_KE"}
)

# Validate with SovereignGuardrail
guardrail.validate_action(
    action_type='Data_Retention',
    payload={
        'key_id': key_id,
        'retention_policy': 'HOT',
        'record_date': '2025-12-23',
        'data_type': 'PHI'
    },
    jurisdiction='KDPA_KE'
)
```

## Performance

- **Encryption**: ~1ms per record (1KB)
- **Decryption**: ~1ms per record (1KB)
- **Key shredding**: ~0.1ms per key
- **Auto-shred**: ~100 keys/second

## Storage efficiency

Crypto Shredder is storage-efficient:

- **Encrypted data**: Same size as plaintext + 32 bytes (IV + tag)
- **Key metadata**: ~500 bytes per key
- **No deletion overhead**: No need to overwrite disk sectors

## Best practices

<Steps>
  <Step title="Use appropriate retention policies">
    Match retention to legal requirements (HOT for operations, COLD for legal hold)
  </Step>
  <Step title="Enable audit logging">
    Always enable audit trail for compliance verification
  </Step>
  <Step title="Run auto-shred daily">
    Schedule auto-shred to run daily at low-traffic hours
  </Step>
  <Step title="Monitor key status">
    Track key expiration and shredding metrics
  </Step>
  <Step title="Test recovery">
    Regularly test that shredded keys cannot decrypt data
  </Step>
</Steps>

## Troubleshooting

<AccordionGroup>
  <Accordion title="Decryption fails">
    **Cause:** Key may be shredded or corrupted
    **Solution:** Check key status with `get_key_status()`
  </Accordion>
  <Accordion title="Auto-shred not running">
    **Cause:** Cron job not configured
    **Solution:** Add auto-shred to crontab
  </Accordion>
  <Accordion title="Key storage full">
    **Cause:** Too many keys accumulated
    **Solution:** Run auto-shred to clean up expired keys
  </Accordion>
  <Accordion title="Audit log missing">
    **Cause:** Audit logging disabled
    **Solution:** Enable with `enable_audit=True`
  </Accordion>
</AccordionGroup>

## Next steps

<CardGroup cols={2}>
  <Card
    title="SovereignGuardrail"
    icon="shield-check"
    href="/governance/overview"
  >
    Integrate with compliance enforcement
  </Card>
  <Card
    title="Security workflows"
    icon="workflow"
    href="/security/workflows"
  >
    Set up automated security scanning
  </Card>
  <Card
    title="Deployment"
    icon="rocket"
    href="/deployment/overview"
  >
    Deploy to production
  </Card>
  <Card
    title="API integration"
    icon="terminal"
    href="/api-reference/overview"
  >
    Use Crypto Shredder in APIs
  </Card>
</CardGroup>
