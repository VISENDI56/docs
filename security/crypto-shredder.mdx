---
title: Crypto Shredder (IP-02)
description: Data is not deleted; it is cryptographically dissolved
---

## Overview

**IP-02: Crypto Shredder** is iLuminara's proprietary data dissolution protocol. Instead of deleting data, we encrypt it with ephemeral keys and shred the keys after retention periods, making data cryptographically irrecoverable.

<Card
  title="Philosophy"
  icon="fire"
>
  "Data is not deleted. It is cryptographically dissolved."
</Card>

## The problem with deletion

Traditional data deletion has fundamental flaws:

<AccordionGroup>
  <Accordion title="Forensic recovery">
    Deleted data can be recovered using forensic tools (magnetic remanence, file carving)
  </Accordion>
  <Accordion title="Backup persistence">
    Data persists in backups, snapshots, and replicas
  </Accordion>
  <Accordion title="Compliance gaps">
    GDPR Art. 17 "Right to Erasure" requires data to be irrecoverable, not just deleted
  </Accordion>
  <Accordion title="Audit trail loss">
    Deletion destroys audit trails needed for compliance
  </Accordion>
</AccordionGroup>

## The Crypto Shredder solution

<Steps>
  <Step title="Encrypt with ephemeral key">
    Data is encrypted using AES-256-GCM with a randomly generated ephemeral key
  </Step>
  <Step title="Store encrypted data">
    Encrypted data is stored with metadata (retention policy, jurisdiction, consent)
  </Step>
  <Step title="Shred the key">
    After retention period, the key is cryptographically overwritten (DoD 5220.22-M standard)
  </Step>
  <Step title="Data becomes irrecoverable">
    Without the key, encrypted data is computationally infeasible to decrypt (2^256 keyspace)
  </Step>
</Steps>

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CRYPTO SHREDDER                          â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚  Plain Data  â”‚  â”€â”€â”€â”€â”€â”€>â”‚ AES-256-GCM  â”‚                â”‚
â”‚  â”‚  (PHI/PII)   â”‚         â”‚  Encryption  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                   â”‚                         â”‚
â”‚                                   â–¼                         â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚                          â”‚ Encrypted Data  â”‚               â”‚
â”‚                          â”‚ + Ephemeral Key â”‚               â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                   â”‚                         â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                    â”‚                             â”‚         â”‚
â”‚                    â–¼                             â–¼         â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚           â”‚  Storage Layer  â”‚         â”‚  Key Ledger  â”‚    â”‚
â”‚           â”‚  (Encrypted)    â”‚         â”‚  (Metadata)  â”‚    â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                              â”‚             â”‚
â”‚                                              â”‚ Retention   â”‚
â”‚                                              â”‚ Expired?    â”‚
â”‚                                              â–¼             â”‚
â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                                    â”‚  KEY SHREDDER    â”‚   â”‚
â”‚                                    â”‚  (DoD 5220.22-M) â”‚   â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â”‚                    DATA NOW IRRECOVERABLE                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Implementation

### Basic usage

```python
from governance_kernel.crypto_shredder import CryptoShredder, RetentionPolicy, SovereigntyZone

# Initialize Crypto Shredder
shredder = CryptoShredder(
    key_storage_path="./keys",
    sovereignty_zone=SovereigntyZone.KENYA,
    enable_audit=True
)

# Encrypt patient data
patient_data = b"Patient ID: 12345, Diagnosis: Malaria, Location: Dadaab"

encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT,
    metadata={
        "patient_id": "12345",
        "jurisdiction": "KDPA_KE",
        "data_type": "PHI"
    }
)

print(f"âœ… Encrypted - Key ID: {key_id}")
```

### Decryption (while key exists)

```python
# Decrypt data
decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)

if decrypted_data:
    print(f"âœ… Decrypted: {decrypted_data.decode()}")
else:
    print("âŒ Decryption failed - Key may be shredded")
```

### Key shredding

```python
# Manually shred key (data becomes irrecoverable)
shredder.shred_key(key_id)

# Try to decrypt after shredding
decrypted_data = shredder.decrypt_with_key(encrypted_data, key_id)
print(f"Result: {decrypted_data}")  # None - data is irrecoverable
```

### Auto-shred expired keys

```python
# Automatically shred all expired keys
shredded_count = shredder.auto_shred_expired_keys()
print(f"ğŸ”¥ Auto-shred complete - {shredded_count} keys shredded")
```

## Retention policies

The Crypto Shredder supports four retention policies aligned with global frameworks:

| Policy | Duration | Description | Use Case |
|--------|----------|-------------|----------|
| **HOT** | 180 days | Active operational data | Recent patient records, ongoing surveillance |
| **WARM** | 365 days | Compliance minimum (HIPAA) | Historical records, audit trails |
| **COLD** | 1825 days | Legal hold maximum (GDPR Art. 17) | Long-term archival, legal requirements |
| **ETERNAL** | Never | Requires explicit justification | Research data, anonymized aggregates |

### Setting retention policy

```python
# HOT: 6 months (default for operational data)
encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT
)

# COLD: 5 years (legal hold)
encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=legal_record,
    retention_policy=RetentionPolicy.COLD
)
```

## Sovereignty zones

Data residency is enforced through sovereignty zones:

```python
from governance_kernel.crypto_shredder import SovereigntyZone

# Kenya (KDPA jurisdiction)
shredder_ke = CryptoShredder(sovereignty_zone=SovereigntyZone.KENYA)

# EU (GDPR jurisdiction)
shredder_eu = CryptoShredder(sovereignty_zone=SovereigntyZone.EU)

# South Africa (POPIA jurisdiction)
shredder_za = CryptoShredder(sovereignty_zone=SovereigntyZone.SOUTH_AFRICA)
```

**Supported zones:**
- `EU` - GDPR jurisdiction (eu-west1)
- `KENYA` - KDPA jurisdiction (africa-south1)
- `SOUTH_AFRICA` - POPIA jurisdiction (africa-south1)
- `CANADA` - PIPEDA jurisdiction (northamerica-northeast1)
- `USA` - HIPAA jurisdiction (us-central1)

## Key metadata

Each ephemeral key stores comprehensive metadata:

```json
{
  "key_id": "a3f5c8d2e1b4f7a9",
  "created_at": "2025-12-25T10:00:00.000Z",
  "expires_at": "2026-06-23T10:00:00.000Z",
  "retention_policy": "HOT",
  "sovereignty_zone": "africa-south1",
  "metadata": {
    "patient_id": "12345",
    "jurisdiction": "KDPA_KE",
    "data_type": "PHI"
  },
  "shredded": false
}
```

## Audit trail

Every Crypto Shredder operation is logged to a tamper-proof audit trail:

```python
# Enable audit logging
shredder = CryptoShredder(enable_audit=True)

# Operations are automatically logged
encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(data)
shredder.decrypt_with_key(encrypted_data, key_id)
shredder.shred_key(key_id)

# View audit log
print(shredder.audit_log)
```

**Audit log format:**

```json
{
  "timestamp": "2025-12-25T10:00:00.000Z",
  "action": "ENCRYPT",
  "key_id": "a3f5c8d2e1b4f7a9",
  "sovereignty_zone": "africa-south1",
  "metadata": {
    "patient_id": "12345",
    "jurisdiction": "KDPA_KE"
  }
}
```

## Compliance mapping

The Crypto Shredder ensures compliance with global data protection frameworks:

### GDPR Art. 17 (Right to Erasure)

```python
# Patient requests data deletion
shredder.shred_key(patient_key_id)

# Data is now cryptographically irrecoverable
# Complies with GDPR Art. 17 "Right to be Forgotten"
```

### HIPAA Â§164.530(j) (Documentation)

```python
# HIPAA requires 6-year retention minimum
shredder.encrypt_with_ephemeral_key(
    data=medical_record,
    retention_policy=RetentionPolicy.COLD  # 5 years
)
```

### NIST SP 800-88 (Media Sanitization)

```python
# DoD 5220.22-M standard: 3-pass overwrite
# Implemented in shred_key() method
shredder.shred_key(key_id)
```

### ISO 27001 A.8.3.2 (Disposal of Media)

```python
# Secure disposal through cryptographic shredding
shredder.auto_shred_expired_keys()
```

## Integration with SovereignGuardrail

The Crypto Shredder integrates with the SovereignGuardrail for compliance enforcement:

```python
from governance_kernel.vector_ledger import SovereignGuardrail
from governance_kernel.crypto_shredder import CryptoShredder

guardrail = SovereignGuardrail()
shredder = CryptoShredder()

# Validate before encryption
guardrail.validate_action(
    action_type='Data_Processing',
    payload={
        'data_type': 'PHI',
        'processing_location': 'Edge_Node',
        'consent_token': 'VALID_TOKEN'
    },
    jurisdiction='KDPA_KE'
)

# Encrypt with validated metadata
encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT,
    metadata={'jurisdiction': 'KDPA_KE'}
)
```

## Scheduled auto-shredding

Set up automated key shredding with cron:

```bash
# Add to crontab
0 2 * * * /usr/bin/python3 /path/to/auto_shred.py
```

**auto_shred.py:**

```python
from governance_kernel.crypto_shredder import CryptoShredder

shredder = CryptoShredder(enable_audit=True)
shredded_count = shredder.auto_shred_expired_keys()

print(f"ğŸ”¥ Auto-shred complete - {shredded_count} keys shredded")
```

## Performance

- **Encryption**: ~1ms per record (AES-256-GCM hardware acceleration)
- **Decryption**: ~1ms per record
- **Key shredding**: ~10ms per key (3-pass overwrite)
- **Auto-shred**: ~100 keys/second

## Security guarantees

<AccordionGroup>
  <Accordion title="Cryptographic strength">
    AES-256-GCM provides 2^256 keyspace (340 undecillion combinations). Brute force is computationally infeasible.
  </Accordion>
  <Accordion title="Key isolation">
    Keys are stored separately from encrypted data. Compromise of storage does not compromise keys.
  </Accordion>
  <Accordion title="Tamper-proof audit">
    All operations are logged with SHA-256 hash chain. Audit trail cannot be modified without detection.
  </Accordion>
  <Accordion title="DoD-grade shredding">
    Keys are overwritten using DoD 5220.22-M standard (3-pass random overwrite).
  </Accordion>
</AccordionGroup>

## Best practices

<Steps>
  <Step title="Use appropriate retention policies">
    Match retention to legal requirements (HOT for operational, COLD for legal hold)
  </Step>
  <Step title="Enable audit logging">
    Always enable audit trails for compliance attestation
  </Step>
  <Step title="Automate key shredding">
    Set up cron jobs for daily auto-shred of expired keys
  </Step>
  <Step title="Backup key metadata">
    Store key metadata (not keys!) in tamper-proof ledger
  </Step>
  <Step title="Test recovery procedures">
    Regularly test that shredded data is truly irrecoverable
  </Step>
</Steps>

## Troubleshooting

<AccordionGroup>
  <Accordion title="Decryption fails">
    Check if key has been shredded or expired. Use `get_key_status(key_id)` to verify.
  </Accordion>
  <Accordion title="Key not found">
    Verify `key_storage_path` is correct and key file exists.
  </Accordion>
  <Accordion title="Auto-shred not running">
    Check cron job is configured and Python path is correct.
  </Accordion>
  <Accordion title="Performance issues">
    Enable hardware AES acceleration (AES-NI on x86, NEON on ARM).
  </Accordion>
</AccordionGroup>

## Next steps

<CardGroup cols={2}>
  <Card
    title="SovereignGuardrail"
    icon="shield-check"
    href="/security/sovereign-guardrail"
  >
    Configure 14-framework enforcement
  </Card>
  <Card
    title="Security workflows"
    icon="workflow"
    href="/security/codeql-gitleaks"
  >
    Set up CodeQL and Gitleaks
  </Card>
  <Card
    title="Governance kernel"
    icon="scale-balanced"
    href="/governance/overview"
  >
    Complete governance documentation
  </Card>
  <Card
    title="Deployment"
    icon="rocket"
    href="/deployment/overview"
  >
    Deploy with Crypto Shredder enabled
  </Card>
</CardGroup>
