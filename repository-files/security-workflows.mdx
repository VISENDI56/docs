---
title: Security workflows
description: Implementation guide for CodeQL, Gitleaks, and Dependabot
---

## Overview

This page provides the complete implementation files for the iLuminara-Core Security Audit Layer. Copy these files to your repository to activate the Sovereign Health Fortress.

## File Structure

```
iLuminara-Core/
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îú‚îÄ‚îÄ workflows/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ codeql.yml          # SAST security scanning
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gitleaks.yml        # Secret detection
‚îÇ   ‚îî‚îÄ‚îÄ dependabot.yml          # Daily security updates
‚îú‚îÄ‚îÄ .gitleaks.toml              # Secret detection rules
‚îú‚îÄ‚îÄ governance_kernel/
‚îÇ   ‚îî‚îÄ‚îÄ crypto_shredder.py      # IP-02 implementation
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ sovereign_guardrail.yaml # Compliance configuration
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ validate_fortress.sh    # Fortress validation
‚îî‚îÄ‚îÄ generate_full_docs.py       # Total ingestion engine
```

## Installation

### Step 1: Copy Security Workflows

```bash
# Create directories
mkdir -p .github/workflows

# Copy CodeQL workflow
cat > .github/workflows/codeql.yml << 'EOF'
# See full content in CodeQL section below
EOF

# Copy Gitleaks workflow
cat > .github/workflows/gitleaks.yml << 'EOF'
# See full content in Gitleaks section below
EOF

# Copy Dependabot config
cat > .github/dependabot.yml << 'EOF'
# See full content in Dependabot section below
EOF

# Copy Gitleaks config
cat > .gitleaks.toml << 'EOF'
# See full content in Gitleaks Config section below
EOF
```

### Step 2: Copy Governance Files

```bash
# Create directories
mkdir -p governance_kernel config scripts

# Copy Crypto Shredder
# See Crypto Shredder section below

# Copy SovereignGuardrail config
# See SovereignGuardrail section below

# Copy validation script
# See Validation Script section below
```

### Step 3: Copy Ingestion Engine

```bash
# Copy ingestion script
# See Ingestion Engine section below

# Make executable
chmod +x generate_full_docs.py
chmod +x scripts/validate_fortress.sh
```

## CodeQL Workflow

**File:** `.github/workflows/codeql.yml`

This workflow provides SAST (Static Application Security Testing) for Python and JavaScript code.

<Accordion title="View complete CodeQL workflow">
```yaml
name: "CodeQL Security Analysis"

on:
  push:
    branches: [ "main", "develop" ]
  pull_request:
    branches: [ "main" ]
  schedule:
    - cron: '0 0 * * 0'  # Weekly on Sunday at midnight UTC

jobs:
  analyze:
    name: Analyze (${{ matrix.language }})
    runs-on: ubuntu-latest
    timeout-minutes: 360
    permissions:
      security-events: write
      packages: read
      actions: read
      contents: read

    strategy:
      fail-fast: false
      matrix:
        language: [ 'python', 'javascript' ]

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Initialize CodeQL
      uses: github/codeql-action/init@v3
      with:
        languages: ${{ matrix.language }}
        queries: +security-extended,security-and-quality
        config: |
          paths-ignore:
            - '**/test/**'
            - '**/tests/**'
            - '**/node_modules/**'
            - '**/venv/**'

    - name: Autobuild
      uses: github/codeql-action/autobuild@v3

    - name: Perform CodeQL Analysis
      uses: github/codeql-action/analyze@v3
      with:
        category: "/language:${{matrix.language}}"
        upload: true

    - name: iLuminara Sovereignty Check
      if: always()
      run: |
        echo "üõ°Ô∏è FORTRESS STATUS: CodeQL scan complete"
        echo "üìä Compliance: GDPR Art. 32 (Security of Processing)"
        echo "üîí Framework: ISO 27001 A.12.6 (Technical Vulnerability Management)"
```
</Accordion>

**Compliance:**
- GDPR Art. 32 (Security of Processing)
- ISO 27001 A.12.6 (Technical Vulnerability Management)
- SOC 2 (Security Monitoring)

## Gitleaks Workflow

**File:** `.github/workflows/gitleaks.yml`

This workflow detects hardcoded secrets, API keys, and credentials.

<Accordion title="View complete Gitleaks workflow">
```yaml
name: "Gitleaks Secret Scanning"

on:
  push:
    branches: [ "main", "develop" ]
  pull_request:
    branches: [ "main" ]
  schedule:
    - cron: '0 2 * * *'  # Daily at 2 AM UTC

jobs:
  scan:
    name: Gitleaks Secret Detection
    runs-on: ubuntu-latest
    permissions:
      contents: read
      security-events: write

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0  # Full history for comprehensive scanning

    - name: Run Gitleaks
      uses: gitleaks/gitleaks-action@v2
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        GITLEAKS_LICENSE: ${{ secrets.GITLEAKS_LICENSE }}
      with:
        config-path: .gitleaks.toml

    - name: Upload SARIF results
      if: always()
      uses: github/codeql-action/upload-sarif@v3
      with:
        sarif_file: results.sarif

    - name: iLuminara Crypto Attestation
      if: always()
      run: |
        echo "üîê CRYPTO SHREDDER STATUS: Secret scan complete"
        echo "üìä Compliance: NIST SP 800-53 (IA-5 Authenticator Management)"
        echo "üõ°Ô∏è Framework: HIPAA ¬ß164.312(a)(2)(i) (Unique User Identification)"
        echo "‚ö° IP-02: Ephemeral key validation active"
```
</Accordion>

**Compliance:**
- NIST SP 800-53 (IA-5 Authenticator Management)
- HIPAA ¬ß164.312(a)(2)(i) (Unique User Identification)

## Gitleaks Configuration

**File:** `.gitleaks.toml`

Custom rules for secret detection with sovereignty awareness.

<Accordion title="View complete Gitleaks configuration">
```toml
# iLuminara-Core Gitleaks Configuration
# Sovereign Health Fortress - Secret Detection Rules

title = "iLuminara Gitleaks Config"

[extend]
useDefault = true

[[rules]]
id = "gcp-api-key"
description = "Google Cloud Platform API Key"
regex = '''AIza[0-9A-Za-z\\-_]{35}'''
tags = ["key", "GCP", "sovereignty-critical"]

[[rules]]
id = "gcp-service-account"
description = "Google Cloud Service Account JSON"
regex = '''"type":\s*"service_account"'''
tags = ["key", "GCP", "sovereignty-critical"]

[[rules]]
id = "aws-access-key"
description = "AWS Access Key (BLOCKED - Sovereignty Violation)"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["key", "AWS", "sovereignty-violation"]

[[rules]]
id = "private-key"
description = "Private Key"
regex = '''-----BEGIN (RSA|EC|OPENSSH|PGP) PRIVATE KEY-----'''
tags = ["key", "crypto-shredder"]

[[rules]]
id = "slack-token"
description = "Slack Token"
regex = '''xox[baprs]-[0-9]{10,13}-[0-9]{10,13}-[a-zA-Z0-9]{24,32}'''
tags = ["token", "slack"]

[[rules]]
id = "github-token"
description = "GitHub Personal Access Token"
regex = '''ghp_[0-9a-zA-Z]{36}'''
tags = ["token", "github"]

[[rules]]
id = "jwt-token"
description = "JWT Token"
regex = '''eyJ[A-Za-z0-9-_=]+\.eyJ[A-Za-z0-9-_=]+\.[A-Za-z0-9-_.+/=]*'''
tags = ["token", "jwt"]

[allowlist]
description = "Allowlist for test files and documentation"
paths = [
  '''.*_test\.py''',
  '''.*_test\.go''',
  '''.*/tests/.*''',
  '''.*/test/.*''',
  '''.*\.md''',
  '''.*\.example''',
]

regexes = [
  '''example\.com''',
  '''localhost''',
  '''127\.0\.0\.1''',
  '''0\.0\.0\.0''',
  '''EXAMPLE_KEY''',
  '''YOUR_API_KEY''',
  '''<YOUR_.*>''',
]
```
</Accordion>

## Dependabot Configuration

**File:** `.github/dependabot.yml`

Daily automated security updates for all dependencies.

<Accordion title="View complete Dependabot configuration">
```yaml
# iLuminara-Core Dependabot Configuration
# Daily security updates for the Sovereign Health Fortress

version: 2

updates:
  # Python dependencies
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "daily"
      time: "02:00"
      timezone: "UTC"
    open-pull-requests-limit: 10
    reviewers:
      - "VISENDI56"
    labels:
      - "dependencies"
      - "security"
      - "fortress-maintenance"
    commit-message:
      prefix: "chore(deps)"
      include: "scope"
    
    versioning-strategy: increase-if-necessary
    
    ignore:
      - dependency-name: "*"
        update-types: ["version-update:semver-patch"]
    
    groups:
      security:
        patterns:
          - "cryptography"
          - "pyjwt"
          - "requests"
        update-types:
          - "security"
      
      google-cloud:
        patterns:
          - "google-cloud-*"
        update-types:
          - "minor"
          - "patch"
      
      ai-ml:
        patterns:
          - "tensorflow"
          - "torch"
          - "scikit-learn"
          - "shap"
        update-types:
          - "minor"
          - "patch"

  # GitHub Actions
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "02:00"
      timezone: "UTC"
    open-pull-requests-limit: 5
    reviewers:
      - "VISENDI56"
    labels:
      - "dependencies"
      - "github-actions"
      - "fortress-maintenance"
    commit-message:
      prefix: "chore(actions)"

  # Docker
  - package-ecosystem: "docker"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "tuesday"
      time: "02:00"
      timezone: "UTC"
    open-pull-requests-limit: 5
    reviewers:
      - "VISENDI56"
    labels:
      - "dependencies"
      - "docker"
      - "fortress-maintenance"
    commit-message:
      prefix: "chore(docker)"

  # npm (if using JavaScript/TypeScript)
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "daily"
      time: "02:00"
      timezone: "UTC"
    open-pull-requests-limit: 10
    reviewers:
      - "VISENDI56"
    labels:
      - "dependencies"
      - "npm"
      - "fortress-maintenance"
    commit-message:
      prefix: "chore(npm)"
    
    versioning-strategy: increase-if-necessary
    
    groups:
      security:
        patterns:
          - "*"
        update-types:
          - "security"
```
</Accordion>

## Next Steps

<CardGroup cols={2}>
  <Card
    title="Crypto Shredder"
    icon="fire"
    href="/security/overview"
  >
    View IP-02 implementation
  </Card>
  <Card
    title="SovereignGuardrail"
    icon="shield-check"
    href="/governance/overview"
  >
    Configure compliance
  </Card>
  <Card
    title="Validation Script"
    icon="check-circle"
    href="/security/overview"
  >
    Validate fortress status
  </Card>
  <Card
    title="Ingestion Guide"
    icon="book"
    href="/security/overview"
  >
    Complete ingestion guide
  </Card>
</CardGroup>
