# iLuminara-Core SovereignGuardrail Configuration
# Enforces 47 global legal frameworks for health data sovereignty

version: "1.0.0"
fortress_name: "iLuminara Sovereign Health Fortress"

# Jurisdiction Configuration
jurisdiction:
  primary: "KDPA_KE"  # Kenya Data Protection Act
  secondary:
    # Core Privacy & Data Protection (14 frameworks)
    - "GDPR_EU"           # General Data Protection Regulation
    - "PIPEDA_CA"         # Personal Information Protection & Electronic Documents Act
    - "POPIA_ZA"          # Protection of Personal Information Act
    - "HIPAA_US"          # Health Insurance Portability & Accountability Act
    - "HITECH_US"         # Health Information Technology for Economic & Clinical Health
    - "CCPA_US"           # California Consumer Privacy Act
    - "CPRA_US"           # California Privacy Rights Act
    - "LGPD_BR"           # Lei Geral de Proteção de Dados (Brazil)
    - "PDPA_SG"           # Personal Data Protection Act (Singapore)
    - "APPI_JP"           # Act on the Protection of Personal Information (Japan)
    - "PIPL_CN"           # Personal Information Protection Law (China)
    - "PDPA_MY"           # Personal Data Protection Act (Malaysia)
    - "DPD_UK"            # Data Protection Act 2018 (UK)
    
    # Cybersecurity & Information Security (8 frameworks)
    - "NIST_CSF"          # Cybersecurity Framework
    - "ISO_27001"         # Information Security Management
    - "SOC_2"             # Service Organization Control 2
    - "CIS_CONTROLS"      # Center for Internet Security
    - "MITRE_ATTACK"      # Adversarial Tactics, Techniques & Common Knowledge
    - "ISO_22301"         # Business Continuity Management
    - "NIST_800_53"       # Security and Privacy Controls
    - "COBIT"             # Control Objectives for Information Technology
    
    # AI Ethics & Governance (6 frameworks)
    - "EU_AI_ACT"         # Artificial Intelligence Act
    - "IEEE_ETHICS"       # Ethically Aligned Design
    - "UNESCO_AI"         # Recommendation on the Ethics of Artificial Intelligence
    - "OECD_AI"           # AI Principles
    - "ISO_IEC_42001"     # AI Management Systems
    - "NIST_AI_RMF"       # AI Risk Management Framework
    
    # Healthcare-Specific (5 frameworks)
    - "GDPR_ART9"         # GDPR Article 9 (Special Categories)
    - "FDA_21_CFR_PART_11" # Electronic Records & Signatures
    - "GxP_COMPLIANCE"    # Good Practice Guidelines
    - "HIPAA_SECURITY_RULE" # Technical Safeguards
    - "ISO_27799"         # Health Informatics Security
    
    # International Standards (4 frameworks)
    - "ISO_9001"          # Quality Management Systems
    - "ISO_14001"         # Environmental Management
    - "ISO_45001"         # Occupational Health & Safety
    - "ISO_31000"         # Risk Management
    
    # Regional & Sector-Specific (8 frameworks)
    - "AFRICAN_UNION_DATA_POLICY"  # Continental Data Governance
    - "ASEAN_DATA_PRIVACY"         # Association of Southeast Asian Nations
    - "CARICOM_DATA_PROTECTION"    # Caribbean Community
    - "MERCOSUR_DATA_PROTECTION"   # Southern Common Market
    - "EFTA_DATA_PROTECTION"       # European Free Trade Association
    - "APEC_PRIVACY_FRAMEWORK"     # Asia-Pacific Economic Cooperation
    - "FTC_ACT"                    # Federal Trade Commission Act
    - "CAN_SPAM"                   # Controlling Assault of Non-Solicited Pornography
    
    # Humanitarian & Ethical (2 frameworks)
    - "GENEVA_CONVENTION"  # International Humanitarian Law
    - "IHR_2005"           # International Health Regulations

# Data Sovereignty Rules
sovereignty:
  # Rule 1: PHI cannot leave sovereign territory
  data_residency:
    enabled: true
    allowed_zones:
      - "africa-south1"      # Kenya, South Africa
      - "europe-west1"       # EU (GDPR)
      - "northamerica-northeast1"  # Canada (PIPEDA)
      - "us-central1"        # USA (HIPAA) - requires explicit consent
    
    blocked_zones:
      - "asia-*"             # Sovereignty violation
      - "australia-*"        # Sovereignty violation
      - "southamerica-*"     # Sovereignty violation
    
    enforcement_level: "STRICT"  # STRICT | MODERATE | PERMISSIVE
    
  # Rule 2: Cross-border transfers require explicit authorization
  cross_border_transfers:
    enabled: true
    require_authorization: true
    authorization_authority: "Data Protection Commissioner"
    
    # Standard Contractual Clauses (GDPR Art. 46)
    scc_required: true
    
    # Adequacy decisions (GDPR Art. 45)
    adequacy_whitelist:
      - "EU"
      - "UK"
      - "Switzerland"
      - "Canada"
      - "Japan"
      - "South Korea"

# Right to Explanation (EU AI Act §6, GDPR Art. 22)
explainability:
  enabled: true
  
  # High-risk AI systems require explanation
  high_risk_threshold: 0.7  # Confidence score
  
  # Explanation methods
  methods:
    - "SHAP"           # SHapley Additive exPlanations
    - "LIME"           # Local Interpretable Model-agnostic Explanations
    - "Feature_Importance"
    - "Attention_Weights"
    - "Counterfactual_Explanations"
  
  # Minimum explanation requirements
  requirements:
    - "confidence_score"
    - "evidence_chain"
    - "feature_contributions"
    - "decision_rationale"
    - "alternative_outcomes"

# Consent Management (GDPR Art. 6, POPIA §11, CCPA §1798.100)
consent:
  enabled: true
  
  # Consent must be explicit for PHI
  require_explicit_consent: true
  
  # Consent scope
  valid_scopes:
    - "diagnosis"
    - "treatment"
    - "research"
    - "public_health_surveillance"
    - "emergency_response"
    - "quality_improvement"
    - "billing"
  
  # Consent expiration
  expiration_days: 365
  
  # Emergency override (WHO IHR Article 6)
  emergency_override:
    enabled: true
    conditions:
      - "public_health_emergency"
      - "outbreak_response"
      - "life_threatening_situation"
      - "natural_disaster"
      - "humanitarian_crisis"

# Data Retention (GDPR Art. 17, HIPAA §164.530(j))
retention:
  enabled: true
  
  # Retention policies
  policies:
    HOT:
      days: 180
      description: "Active operational data"
      storage_class: "STANDARD"
    
    WARM:
      days: 365
      description: "Compliance minimum (HIPAA)"
      storage_class: "NEARLINE"
    
    COLD:
      days: 1825
      description: "Legal hold maximum (GDPR Art. 17)"
      storage_class: "COLDLINE"
    
    ETERNAL:
      days: -1
      description: "Never expires (requires explicit justification)"
      storage_class: "ARCHIVE"
  
  # Auto-shred expired keys (IP-02)
  auto_shred_enabled: true
  auto_shred_schedule: "0 2 * * *"  # Daily at 2 AM UTC

# Audit Trail (GDPR Art. 30, HIPAA §164.312(b), SOC 2)
audit:
  enabled: true
  
  # Tamper-proof audit
  tamper_proof: true
  
  # Audit storage
  storage:
    backend: "Cloud_Spanner"  # or "Bigtable", "Local"
    region: "africa-south1"
    retention_days: 2555  # 7 years (HIPAA requirement)
  
  # Cryptographic signing
  signing:
    enabled: true
    algorithm: "SHA256_RSA"
    key_management: "Cloud_KMS"
  
  # Audit events
  events:
    - "Data_Transfer"
    - "High_Risk_Inference"
    - "Consent_Validation"
    - "Data_Retention"
    - "Key_Shred"
    - "Sovereignty_Violation"
    - "Emergency_Override"
    - "Access_Control"
    - "Configuration_Change"
    - "Security_Incident"

# Humanitarian Constraints (Geneva Convention, WHO IHR)
humanitarian:
  enabled: true
  
  # Constraints
  constraints:
    - "Medical_Ethics"
    - "Resource_Allocation"
    - "Data_Protection"
    - "Population_Protection"
    - "Emergency_Response"
    - "Non_Discrimination"
    - "Proportionality"
  
  # Margin calculation
  margin_threshold: 0.15  # 15% humanitarian margin
  
  # Emergency protocols
  emergency_protocols:
    - "WHO_IHR_Article_6"
    - "Geneva_Convention_Article_3"
    - "UN_Humanitarian_Principles"
    - "Sphere_Standards"
    - "Core_Humanitarian_Standard"

# Compliance Frameworks (47 Total)
frameworks:
  # Core Privacy & Data Protection (14 frameworks)
  GDPR_EU:
    enabled: true
    region: "European Union"
    articles:
      - "Art. 6 (Lawfulness of Processing)"
      - "Art. 9 (Special Categories)"
      - "Art. 17 (Right to Erasure)"
      - "Art. 22 (Right to Explanation)"
      - "Art. 30 (Records of Processing)"
      - "Art. 32 (Security of Processing)"
      - "Art. 45 (Adequacy Decisions)"
      - "Art. 46 (Standard Contractual Clauses)"
  
  KDPA_KE:
    enabled: true
    region: "Kenya"
    sections:
      - "§37 (Transfer Restrictions)"
      - "§42 (Data Subject Rights)"
      - "§43 (Right to Access)"
      - "§44 (Right to Correction)"
  
  PIPEDA_CA:
    enabled: true
    region: "Canada"
    sections:
      - "§5 (Consent)"
      - "§6 (Limiting Collection)"
      - "§7 (Limiting Use, Disclosure, Retention)"
  
  POPIA_ZA:
    enabled: true
    region: "South Africa"
    sections:
      - "§11 (Lawfulness)"
      - "§14 (Cross-border Transfers)"
      - "§23 (Data Subject Rights)"
  
  HIPAA_US:
    enabled: true
    region: "United States"
    sections:
      - "§164.312 (Physical/Technical Safeguards)"
      - "§164.530(j) (Documentation)"
      - "§164.404 (Breach Notification)"
  
  HITECH_US:
    enabled: true
    region: "United States"
    sections:
      - "§13410 (Notification of Breach)"
      - "§13402 (Notification Requirements)"
  
  CCPA_US:
    enabled: true
    region: "California, USA"
    sections:
      - "§1798.100 (Right to Know)"
      - "§1798.105 (Right to Delete)"
      - "§1798.110 (Right to Access)"
  
  CPRA_US:
    enabled: true
    region: "California, USA"
    sections:
      - "Right to Correct"
      - "Right to Limit Use"
      - "Sensitive Personal Information"
  
  LGPD_BR:
    enabled: true
    region: "Brazil"
    sections:
      - "Art. 7 (Lawful Basis)"
      - "Art. 11 (Sensitive Data)"
      - "Art. 18 (Data Subject Rights)"
  
  PDPA_SG:
    enabled: true
    region: "Singapore"
    sections:
      - "Consent Obligation"
      - "Purpose Limitation"
      - "Notification Obligation"
  
  APPI_JP:
    enabled: true
    region: "Japan"
    sections:
      - "Art. 16 (Purpose of Use)"
      - "Art. 17 (Proper Acquisition)"
      - "Art. 23 (Provision to Third Parties)"
  
  PIPL_CN:
    enabled: true
    region: "China"
    sections:
      - "Art. 13 (Consent)"
      - "Art. 38 (Cross-border Transfer)"
      - "Art. 44 (Data Subject Rights)"
  
  PDPA_MY:
    enabled: true
    region: "Malaysia"
    sections:
      - "General Principle"
      - "Notice and Choice"
      - "Disclosure Principle"
  
  DPD_UK:
    enabled: true
    region: "United Kingdom"
    sections:
      - "Lawfulness, Fairness, Transparency"
      - "Purpose Limitation"
      - "Data Minimization"
  
  # Cybersecurity & Information Security (8 frameworks)
  NIST_CSF:
    enabled: true
    region: "United States"
    functions:
      - "Identify"
      - "Protect"
      - "Detect"
      - "Respond"
      - "Recover"
  
  ISO_27001:
    enabled: true
    region: "Global"
    controls:
      - "A.8.3.2 (Disposal of Media)"
      - "A.12.4 (Logging)"
      - "A.12.6 (Technical Vulnerability Management)"
      - "A.18.1 (Compliance with Legal Requirements)"
  
  SOC_2:
    enabled: true
    region: "United States"
    criteria:
      - "Security"
      - "Availability"
      - "Processing Integrity"
      - "Confidentiality"
      - "Privacy"
  
  CIS_CONTROLS:
    enabled: true
    region: "Global"
    controls:
      - "Inventory and Control of Assets"
      - "Data Protection"
      - "Secure Configuration"
      - "Continuous Vulnerability Management"
  
  MITRE_ATTACK:
    enabled: true
    region: "Global"
    tactics:
      - "Initial Access"
      - "Execution"
      - "Persistence"
      - "Defense Evasion"
  
  ISO_22301:
    enabled: true
    region: "Global"
    requirements:
      - "Business Continuity Planning"
      - "Incident Response"
      - "Recovery Procedures"
  
  NIST_800_53:
    enabled: true
    region: "United States"
    controls:
      - "AC (Access Control)"
      - "AU (Audit and Accountability)"
      - "IA (Identification and Authentication)"
      - "SC (System and Communications Protection)"
  
  COBIT:
    enabled: true
    region: "Global"
    domains:
      - "Evaluate, Direct and Monitor"
      - "Align, Plan and Organize"
      - "Build, Acquire and Implement"
      - "Deliver, Service and Support"
  
  # AI Ethics & Governance (6 frameworks)
  EU_AI_ACT:
    enabled: true
    region: "European Union"
    articles:
      - "§6 (High-Risk AI)"
      - "§8 (Transparency)"
      - "§12 (Record Keeping)"
      - "§13 (Transparency for Users)"
  
  IEEE_ETHICS:
    enabled: true
    region: "Global"
    principles:
      - "Human Rights"
      - "Well-being"
      - "Data Agency"
      - "Effectiveness"
      - "Transparency"
  
  UNESCO_AI:
    enabled: true
    region: "Global"
    values:
      - "Human Dignity"
      - "Living in Peaceful Societies"
      - "Environmental Sustainability"
      - "Cultural Diversity"
  
  OECD_AI:
    enabled: true
    region: "Global"
    principles:
      - "Inclusive Growth"
      - "Sustainable Development"
      - "Human-Centered Values"
      - "Transparency"
      - "Robustness"
  
  ISO_IEC_42001:
    enabled: true
    region: "Global"
    requirements:
      - "AI Management System"
      - "Risk Management"
      - "Performance Evaluation"
  
  NIST_AI_RMF:
    enabled: true
    region: "United States"
    functions:
      - "Govern"
      - "Map"
      - "Measure"
      - "Manage"
  
  # Healthcare-Specific (5 frameworks)
  GDPR_ART9:
    enabled: true
    region: "European Union"
    description: "Special Categories of Personal Data (Health)"
    prohibitions:
      - "Foreign Transfer Without Adequacy"
      - "Processing Without Explicit Consent"
  
  FDA_21_CFR_PART_11:
    enabled: true
    region: "United States"
    requirements:
      - "Electronic Records"
      - "Electronic Signatures"
      - "Audit Trails"
  
  GxP_COMPLIANCE:
    enabled: true
    region: "Global"
    standards:
      - "Good Clinical Practice (GCP)"
      - "Good Laboratory Practice (GLP)"
      - "Good Manufacturing Practice (GMP)"
  
  HIPAA_SECURITY_RULE:
    enabled: true
    region: "United States"
    safeguards:
      - "Administrative Safeguards"
      - "Physical Safeguards"
      - "Technical Safeguards"
  
  ISO_27799:
    enabled: true
    region: "Global"
    controls:
      - "Health Information Security"
      - "Clinical Information Systems"
      - "Personal Health Information"
  
  # International Standards (4 frameworks)
  ISO_9001:
    enabled: true
    region: "Global"
    principles:
      - "Customer Focus"
      - "Leadership"
      - "Process Approach"
      - "Continuous Improvement"
  
  ISO_14001:
    enabled: true
    region: "Global"
    requirements:
      - "Environmental Policy"
      - "Planning"
      - "Implementation"
  
  ISO_45001:
    enabled: true
    region: "Global"
    requirements:
      - "Occupational Health and Safety"
      - "Hazard Identification"
      - "Risk Assessment"
  
  ISO_31000:
    enabled: true
    region: "Global"
    principles:
      - "Risk Identification"
      - "Risk Analysis"
      - "Risk Evaluation"
      - "Risk Treatment"
  
  # Regional & Sector-Specific (8 frameworks)
  AFRICAN_UNION_DATA_POLICY:
    enabled: true
    region: "Africa"
    objectives:
      - "Continental Data Governance"
      - "Digital Sovereignty"
      - "Cross-border Data Flows"
  
  ASEAN_DATA_PRIVACY:
    enabled: true
    region: "Southeast Asia"
    principles:
      - "Consent"
      - "Purpose Limitation"
      - "Data Security"
  
  CARICOM_DATA_PROTECTION:
    enabled: true
    region: "Caribbean"
    requirements:
      - "Data Protection Principles"
      - "Cross-border Transfer Rules"
  
  MERCOSUR_DATA_PROTECTION:
    enabled: true
    region: "South America"
    principles:
      - "Data Protection"
      - "Privacy Rights"
  
  EFTA_DATA_PROTECTION:
    enabled: true
    region: "European Free Trade Association"
    requirements:
      - "GDPR Alignment"
      - "Data Protection Standards"
  
  APEC_PRIVACY_FRAMEWORK:
    enabled: true
    region: "Asia-Pacific"
    principles:
      - "Preventing Harm"
      - "Notice"
      - "Collection Limitation"
      - "Uses of Personal Information"
  
  FTC_ACT:
    enabled: true
    region: "United States"
    sections:
      - "§5 (Unfair or Deceptive Practices)"
      - "Consumer Protection"
  
  CAN_SPAM:
    enabled: true
    region: "United States"
    requirements:
      - "Opt-out Mechanism"
      - "Accurate Header Information"
      - "Identification as Advertisement"
  
  # Humanitarian & Ethical (2 frameworks)
  GENEVA_CONVENTION:
    enabled: true
    region: "Global"
    articles:
      - "Article 3 (Common Article 3)"
      - "Protection of Civilians"
      - "Medical Ethics"
  
  IHR_2005:
    enabled: true
    region: "Global"
    articles:
      - "Article 6 (Notification)"
      - "Article 7 (Information Sharing)"
      - "Article 12 (Public Health Response)"

# Enforcement Actions
enforcement:
  # Violation handling
  on_violation:
    action: "BLOCK"  # BLOCK | WARN | LOG
    notify: true
    escalate: true
  
  # Notification channels
  notifications:
    - type: "Email"
      recipients:
        - "compliance@iluminara.health"
        - "dpo@iluminara.health"
    
    - type: "PubSub"
      topic: "projects/iluminara/topics/sovereignty-violations"
    
    - type: "Slack"
      webhook: "${SLACK_WEBHOOK_URL}"
  
  # Escalation
  escalation:
    enabled: true
    threshold: 3  # violations
    window_minutes: 60
    escalate_to:
      - "Chief Compliance Officer"
      - "Data Protection Officer"
      - "Chief Information Security Officer"

# Integration with Nuclear IP Stack
nuclear_ip:
  IP_02_CRYPTO_SHREDDER:
    enabled: true
    auto_shred: true
    retention_policies:
      - "HOT"
      - "WARM"
      - "COLD"
  
  IP_03_ACORN_PROTOCOL:
    enabled: false  # Requires hardware attestation
    somatic_factors:
      - "posture"
      - "location"
      - "stillness"
  
  IP_04_SILENT_FLUX:
    enabled: false  # Requires anxiety monitoring
    anxiety_threshold: 0.7
  
  IP_05_GOLDEN_THREAD:
    enabled: true
    verification_threshold: 0.8
    data_streams:
      - "CBS"
      - "EMR"
      - "IDSR"
  
  IP_06_5DM_BRIDGE:
    enabled: false  # Requires mobile network integration
    target_nodes: 14000000

# Monitoring & Alerting
monitoring:
  enabled: true
  
  # Metrics
  metrics:
    - "sovereignty_violations_total"
    - "cross_border_transfers_total"
    - "high_risk_inferences_total"
    - "consent_validations_total"
    - "keys_shredded_total"
    - "audit_events_total"
    - "framework_checks_total"
  
  # Prometheus integration
  prometheus:
    enabled: true
    port: 9090
    path: "/metrics"
  
  # Grafana dashboards
  grafana:
    enabled: true
    dashboards:
      - "Sovereignty Compliance (47 Frameworks)"
      - "Audit Trail"
      - "Data Retention"
      - "AI Explainability"
      - "Humanitarian Constraints"

# Development & Testing
development:
  # Relaxed mode for testing
  relaxed_mode: false
  
  # Mock services
  mock_services:
    enabled: false
  
  # Test jurisdiction
  test_jurisdiction: "GLOBAL_DEFAULT"
  
  # Framework testing
  test_all_frameworks: true
