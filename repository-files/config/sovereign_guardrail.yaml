# iLuminara-Core SovereignGuardrail Configuration
# Enforces 47 global legal frameworks for health data sovereignty

version: "1.0.0"
fortress_name: "iLuminara Sovereign Health Fortress"

# Jurisdiction Configuration
jurisdiction:
  primary: "KDPA_KE"  # Kenya Data Protection Act
  secondary:
    - "GDPR_EU"      # European Union
    - "POPIA_ZA"     # South Africa
    - "HIPAA_US"     # United States
    - "PIPEDA_CA"    # Canada

# Data Sovereignty Rules
sovereignty:
  # Rule 1: PHI cannot leave sovereign territory
  data_residency:
    enabled: true
    allowed_zones:
      - "africa-south1"      # Kenya, South Africa
      - "europe-west1"       # EU (GDPR)
      - "northamerica-northeast1"  # Canada (PIPEDA)
      - "us-central1"        # USA (HIPAA) - requires explicit consent
    
    blocked_zones:
      - "asia-*"             # Sovereignty violation
      - "australia-*"        # Sovereignty violation
      - "southamerica-*"     # Sovereignty violation
    
    enforcement_level: "STRICT"  # STRICT | MODERATE | PERMISSIVE
    
  # Rule 2: Cross-border transfers require explicit authorization
  cross_border_transfers:
    enabled: true
    require_authorization: true
    authorization_authority: "Data Protection Commissioner"
    
    # Standard Contractual Clauses (GDPR Art. 46)
    scc_required: true
    
    # Adequacy decisions (GDPR Art. 45)
    adequacy_whitelist:
      - "EU"
      - "UK"
      - "Switzerland"
      - "Canada"

# Right to Explanation (EU AI Act §6, GDPR Art. 22)
explainability:
  enabled: true
  
  # High-risk AI systems require explanation
  high_risk_threshold: 0.7  # Confidence score
  
  # Explanation methods
  methods:
    - "SHAP"           # SHapley Additive exPlanations
    - "LIME"           # Local Interpretable Model-agnostic Explanations
    - "Feature_Importance"
  
  # Minimum explanation requirements
  requirements:
    - "confidence_score"
    - "evidence_chain"
    - "feature_contributions"
    - "decision_rationale"

# Consent Management (GDPR Art. 6, POPIA §11, CCPA §1798.100)
consent:
  enabled: true
  
  # Consent must be explicit for PHI
  require_explicit_consent: true
  
  # Consent scope
  valid_scopes:
    - "diagnosis"
    - "treatment"
    - "research"
    - "public_health_surveillance"
    - "emergency_response"
  
  # Consent expiration
  expiration_days: 365
  
  # Emergency override (WHO IHR Article 6)
  emergency_override:
    enabled: true
    conditions:
      - "public_health_emergency"
      - "outbreak_response"
      - "life_threatening_situation"

# Data Retention (GDPR Art. 17, HIPAA §164.530(j))
retention:
  enabled: true
  
  # Retention policies
  policies:
    HOT:
      days: 180
      description: "Active operational data"
      storage_class: "STANDARD"
    
    WARM:
      days: 365
      description: "Compliance minimum (HIPAA)"
      storage_class: "NEARLINE"
    
    COLD:
      days: 1825
      description: "Legal hold maximum (GDPR Art. 17)"
      storage_class: "COLDLINE"
    
    ETERNAL:
      days: -1
      description: "Never expires (requires explicit justification)"
      storage_class: "ARCHIVE"
  
  # Auto-shred expired keys (IP-02)
  auto_shred_enabled: true
  auto_shred_schedule: "0 2 * * *"  # Daily at 2 AM UTC

# Audit Trail (GDPR Art. 30, HIPAA §164.312(b), SOC 2)
audit:
  enabled: true
  
  # Tamper-proof audit
  tamper_proof: true
  
  # Audit storage
  storage:
    backend: "Cloud_Spanner"  # or "Bigtable", "Local"
    region: "africa-south1"
    retention_days: 2555  # 7 years (HIPAA requirement)
  
  # Cryptographic signing
  signing:
    enabled: true
    algorithm: "SHA256_RSA"
    key_management: "Cloud_KMS"
  
  # Audit events
  events:
    - "Data_Transfer"
    - "High_Risk_Inference"
    - "Consent_Validation"
    - "Data_Retention"
    - "Key_Shred"
    - "Sovereignty_Violation"
    - "Emergency_Override"

# Humanitarian Constraints (Geneva Convention, WHO IHR)
humanitarian:
  enabled: true
  
  # Constraints
  constraints:
    - "Medical_Ethics"
    - "Resource_Allocation"
    - "Data_Protection"
    - "Population_Protection"
    - "Emergency_Response"
  
  # Margin calculation
  margin_threshold: 0.15  # 15% humanitarian margin
  
  # Emergency protocols
  emergency_protocols:
    - "WHO_IHR_Article_6"
    - "Geneva_Convention_Article_3"
    - "UN_Humanitarian_Principles"

# Compliance Frameworks (47 Total)
frameworks:
  # ═══════════════════════════════════════════════════════════════
  # TIER 1: Core Privacy & Data Protection (14 frameworks)
  # ═══════════════════════════════════════════════════════════════
  GDPR:
    enabled: true
    region: "EU"
    articles:
      - "Art. 6 (Lawfulness of Processing)"
      - "Art. 9 (Special Categories)"
      - "Art. 17 (Right to Erasure)"
      - "Art. 22 (Right to Explanation)"
      - "Art. 30 (Records of Processing)"
      - "Art. 32 (Security of Processing)"
  
  KDPA:
    enabled: true
    region: "Kenya"
    sections:
      - "§37 (Transfer Restrictions)"
      - "§42 (Data Subject Rights)"
  
  HIPAA:
    enabled: true
    region: "USA"
    sections:
      - "§164.312 (Physical/Technical Safeguards)"
      - "§164.530(j) (Documentation)"
  
  HITECH:
    enabled: true
    region: "USA"
    sections:
      - "§13410 (Notification of Breach)"
  
  PIPEDA:
    enabled: true
    region: "Canada"
    sections:
      - "§5-7 (Lawfulness of Processing)"
  
  POPIA:
    enabled: true
    region: "South Africa"
    sections:
      - "§11 (Lawfulness)"
      - "§14 (Cross-border Transfers)"
  
  CCPA:
    enabled: true
    region: "California, USA"
    sections:
      - "§1798.100 (Right to Know)"
  
  CPRA:
    enabled: true
    region: "California, USA"
    sections:
      - "Enhanced consumer rights (2023)"
  
  LGPD:
    enabled: true
    region: "Brazil"
    articles:
      - "Art. 11 (Sensitive Personal Data)"
  
  PDPA_SG:
    enabled: true
    region: "Singapore"
    sections:
      - "Personal Data Protection Act"
  
  APPI:
    enabled: true
    region: "Japan"
    articles:
      - "Art. 23 (Third-party Provision)"
  
  PIPL:
    enabled: true
    region: "China"
    sections:
      - "Personal Information Protection Law"
  
  PDPA_MY:
    enabled: true
    region: "Malaysia"
    sections:
      - "Personal Data Protection Act"
  
  DPD_UK:
    enabled: true
    region: "United Kingdom"
    sections:
      - "Data Protection Act 2018"
  
  # ═══════════════════════════════════════════════════════════════
  # TIER 2: Cybersecurity & Information Security (8 frameworks)
  # ═══════════════════════════════════════════════════════════════
  NIST_CSF:
    enabled: true
    region: "USA"
    functions:
      - "Identify"
      - "Protect"
      - "Detect"
      - "Respond"
      - "Recover"
  
  ISO_27001:
    enabled: true
    region: "Global"
    controls:
      - "A.8.3.2 (Disposal of Media)"
      - "A.12.4 (Logging)"
      - "A.12.6 (Technical Vulnerability Management)"
  
  SOC_2:
    enabled: true
    region: "USA"
    criteria:
      - "Security"
      - "Availability"
      - "Processing Integrity"
  
  CIS_CONTROLS:
    enabled: true
    region: "Global"
    controls:
      - "Center for Internet Security Controls"
  
  MITRE_ATTACK:
    enabled: true
    region: "Global"
    framework:
      - "Adversarial Tactics, Techniques & Common Knowledge"
  
  ISO_22301:
    enabled: true
    region: "Global"
    standard:
      - "Business Continuity Management"
  
  NIST_800_53:
    enabled: true
    region: "USA"
    controls:
      - "Security and Privacy Controls"
  
  COBIT:
    enabled: true
    region: "Global"
    framework:
      - "Control Objectives for Information Technology"
  
  # ═══════════════════════════════════════════════════════════════
  # TIER 3: AI Ethics & Governance (6 frameworks)
  # ═══════════════════════════════════════════════════════════════
  EU_AI_ACT:
    enabled: true
    region: "EU"
    articles:
      - "§6 (High-Risk AI)"
      - "§8 (Transparency)"
      - "§12 (Record Keeping)"
  
  IEEE_ETHICS:
    enabled: true
    region: "Global"
    principles:
      - "Ethically Aligned Design"
  
  UNESCO_AI:
    enabled: true
    region: "Global"
    recommendation:
      - "Recommendation on the Ethics of Artificial Intelligence"
  
  OECD_AI:
    enabled: true
    region: "Global"
    principles:
      - "AI Principles"
  
  ISO_IEC_42001:
    enabled: true
    region: "Global"
    standard:
      - "AI Management Systems"
  
  NIST_AI_RMF:
    enabled: true
    region: "USA"
    framework:
      - "AI Risk Management Framework"
  
  # ═══════════════════════════════════════════════════════════════
  # TIER 4: Healthcare-Specific (5 frameworks)
  # ═══════════════════════════════════════════════════════════════
  GDPR_ART9:
    enabled: true
    region: "EU"
    article:
      - "Article 9 (Special Categories - Sensitive Health Data)"
  
  FDA_21_CFR_PART_11:
    enabled: true
    region: "USA"
    regulation:
      - "Electronic Records & Signatures"
  
  GxP_COMPLIANCE:
    enabled: true
    region: "Global"
    guidelines:
      - "Good Practice Guidelines"
  
  HIPAA_SECURITY_RULE:
    enabled: true
    region: "USA"
    rule:
      - "Technical Safeguards"
  
  ISO_27799:
    enabled: true
    region: "Global"
    standard:
      - "Health Informatics Security"
  
  # ═══════════════════════════════════════════════════════════════
  # TIER 5: International Standards (4 frameworks)
  # ═══════════════════════════════════════════════════════════════
  ISO_9001:
    enabled: true
    region: "Global"
    standard:
      - "Quality Management Systems"
  
  ISO_14001:
    enabled: true
    region: "Global"
    standard:
      - "Environmental Management"
  
  ISO_45001:
    enabled: true
    region: "Global"
    standard:
      - "Occupational Health & Safety"
  
  ISO_31000:
    enabled: true
    region: "Global"
    standard:
      - "Risk Management"
  
  # ═══════════════════════════════════════════════════════════════
  # TIER 6: Regional & Sector-Specific (8 frameworks)
  # ═══════════════════════════════════════════════════════════════
  AFRICAN_UNION_DATA_POLICY:
    enabled: true
    region: "Africa"
    policy:
      - "Continental Data Governance"
  
  ASEAN_DATA_PRIVACY:
    enabled: true
    region: "Southeast Asia"
    framework:
      - "Association of Southeast Asian Nations"
  
  CARICOM_DATA_PROTECTION:
    enabled: true
    region: "Caribbean"
    framework:
      - "Caribbean Community"
  
  MERCOSUR_DATA_PROTECTION:
    enabled: true
    region: "South America"
    framework:
      - "Southern Common Market"
  
  EFTA_DATA_PROTECTION:
    enabled: true
    region: "Europe"
    framework:
      - "European Free Trade Association"
  
  APEC_PRIVACY_FRAMEWORK:
    enabled: true
    region: "Asia-Pacific"
    framework:
      - "Asia-Pacific Economic Cooperation"
  
  FTC_ACT:
    enabled: true
    region: "USA"
    act:
      - "Federal Trade Commission Act"
  
  CAN_SPAM:
    enabled: true
    region: "USA"
    act:
      - "Controlling Assault of Non-Solicited Pornography"
  
  # ═══════════════════════════════════════════════════════════════
  # TIER 7: Humanitarian & Ethical (2 frameworks)
  # ═══════════════════════════════════════════════════════════════
  GENEVA_CONVENTION:
    enabled: true
    region: "Global"
    convention:
      - "International Humanitarian Law"
  
  IHR_2005:
    enabled: true
    region: "Global"
    regulation:
      - "International Health Regulations (2005)"

# Enforcement Actions
enforcement:
  # Violation handling
  on_violation:
    action: "BLOCK"  # BLOCK | WARN | LOG
    notify: true
    escalate: true
  
  # Notification channels
  notifications:
    - type: "Email"
      recipients:
        - "compliance@iluminara.health"
        - "dpo@iluminara.health"
    
    - type: "PubSub"
      topic: "projects/iluminara/topics/sovereignty-violations"
    
    - type: "Slack"
      webhook: "${SLACK_WEBHOOK_URL}"
  
  # Escalation
  escalation:
    enabled: true
    threshold: 3  # violations
    window_minutes: 60
    escalate_to:
      - "Chief Compliance Officer"
      - "Data Protection Officer"

# Integration with Nuclear IP Stack
nuclear_ip:
  IP_02_CRYPTO_SHREDDER:
    enabled: true
    auto_shred: true
  
  IP_03_ACORN_PROTOCOL:
    enabled: false  # Requires hardware attestation
  
  IP_04_SILENT_FLUX:
    enabled: false  # Requires anxiety monitoring
  
  IP_05_GOLDEN_THREAD:
    enabled: true
    verification_threshold: 0.8
  
  IP_06_5DM_BRIDGE:
    enabled: false  # Requires mobile network integration

# Monitoring & Alerting
monitoring:
  enabled: true
  
  # Metrics
  metrics:
    - "sovereignty_violations_total"
    - "cross_border_transfers_total"
    - "high_risk_inferences_total"
    - "consent_validations_total"
    - "keys_shredded_total"
  
  # Prometheus integration
  prometheus:
    enabled: true
    port: 9090
    path: "/metrics"
  
  # Grafana dashboards
  grafana:
    enabled: true
    dashboards:
      - "Sovereignty Compliance"
      - "Audit Trail"
      - "Data Retention"

# Development & Testing
development:
  # Relaxed mode for testing
  relaxed_mode: false
  
  # Mock services
  mock_services:
    enabled: false
  
  # Test jurisdiction
  test_jurisdiction: "GLOBAL_DEFAULT"
