---
title: Bio-Interface REST API
description: Mobile health apps integration with Golden Thread protocol
---

## Overview

The Bio-Interface REST API enables mobile health applications to submit data using the Golden Thread protocol for multi-source data fusion. Designed for offline-first operation with intelligent sync prioritization.

<Card
  title="Philosophy"
  icon="mobile"
>
  "Sovereign agents operate with dignity even in digital darkness."
</Card>

## Key features

<CardGroup cols={2}>
  <Card title="Offline-first" icon="wifi-slash">
    Queue data locally when offline, sync when connected
  </Card>
  <Card title="Golden Thread fusion" icon="link">
    Automatic CBS + EMR + IDSR data verification
  </Card>
  <Card title="Priority sync" icon="bolt">
    Critical data syncs immediately, routine data syncs later
  </Card>
  <Card title="Sovereignty-native" icon="shield-check">
    All endpoints enforce SovereignGuardrail constraints
  </Card>
</CardGroup>

## Base URL

```
http://localhost:8080/api/v1
```

For production: `https://api.iluminara.health/api/v1`

## Authentication

Production deployments should implement:
- Google Cloud IAM
- JWT tokens
- API keys with rate limiting

## Endpoints

### Health check

```bash
GET /health
```

**Response:**

```json
{
  "status": "healthy",
  "service": "Bio-Interface API",
  "version": "1.0.0",
  "timestamp": "2025-01-15T10:00:00Z",
  "fortress_status": "OPERATIONAL"
}
```

### Submit CBS signal

Submit Community-Based Surveillance data from CHVs or mobile apps.

```bash
POST /api/v1/cbs/submit
```

**Request body:**

```json
{
  "patient_id": "PAT_12345",
  "location": {
    "lat": 0.0512,
    "lng": 40.3129
  },
  "symptom": "diarrhea",
  "severity": 8,
  "timestamp": "2025-01-15T08:00:00Z",
  "source": "CHV_AMINA_HASSAN",
  "metadata": {
    "age": 25,
    "gender": "F",
    "village": "Ifo Camp"
  },
  "consent_token": "CBS_EMERGENCY",
  "jurisdiction": "KDPA_KE"
}
```

**Response (201 Created):**

```json
{
  "status": "success",
  "signal_id": "CBS_20250115080000",
  "verification_score": 0.0,
  "sync_priority": "HIGH",
  "message": "CBS signal queued for Golden Thread fusion"
}
```

### Submit EMR record

Submit Electronic Medical Record from clinics or hospitals.

```bash
POST /api/v1/emr/submit
```

**Request body:**

```json
{
  "patient_id": "PAT_12345",
  "location": {
    "lat": 0.0512,
    "lng": 40.3129
  },
  "diagnosis": "cholera",
  "timestamp": "2025-01-15T08:30:00Z",
  "source": "DADAAB_CLINIC",
  "lab_results": {
    "test": "stool_culture",
    "result": "positive",
    "pathogen": "vibrio_cholerae"
  },
  "treatment": {
    "medication": "ORS",
    "dosage": "1L",
    "frequency": "every_4_hours"
  },
  "consent_token": "CLINICAL_CARE",
  "jurisdiction": "KDPA_KE"
}
```

**Response (201 Created):**

```json
{
  "status": "success",
  "record_id": "EMR_20250115083000",
  "fused_record": {
    "patient_id": "PAT_12345",
    "verification_score": 1.0,
    "verification_status": "CONFIRMED",
    "cbs_signal": {
      "symptom": "diarrhea",
      "severity": 8,
      "timestamp": "2025-01-15T08:00:00Z"
    },
    "emr_record": {
      "diagnosis": "cholera",
      "timestamp": "2025-01-15T08:30:00Z"
    },
    "time_delta_hours": 0.5,
    "location_match": true
  },
  "verification_score": 1.0,
  "message": "EMR record fused with CBS signal"
}
```

### Check sync status

Get current sync queue status for offline-first protocol.

```bash
GET /api/v1/sync/status
```

**Response:**

```json
{
  "status": "success",
  "sync_queue": {
    "critical": 0,
    "high": 5,
    "medium": 12,
    "low": 45
  },
  "last_sync": "2025-01-15T10:00:00Z",
  "connectivity": "online"
}
```

### Trigger manual sync

Manually trigger sync for queued data.

```bash
POST /api/v1/sync/trigger
```

**Request body (optional):**

```json
{
  "priority": "HIGH"
}
```

**Response:**

```json
{
  "status": "success",
  "synced_records": 17,
  "message": "Sync completed successfully"
}
```

### Check verification status

Check Golden Thread verification score for a patient.

```bash
POST /api/v1/verification/check
```

**Request body:**

```json
{
  "patient_id": "PAT_12345"
}
```

**Response:**

```json
{
  "status": "success",
  "patient_id": "PAT_12345",
  "verification_score": 1.0,
  "verification_status": "CONFIRMED",
  "data_sources": ["CBS", "EMR"],
  "last_updated": "2025-01-15T08:30:00Z"
}
```

## Sync priority levels

The offline-first protocol uses intelligent priority queuing:

| Priority | Severity Range | Sync Timing | Use Case |
|----------|----------------|-------------|----------|
| **CRITICAL** | 9-10 | Immediate | Life-threatening conditions |
| **HIGH** | 7-8 | Within 1 hour | Outbreak signals, serious illness |
| **MEDIUM** | 4-6 | Within 24 hours | Routine surveillance |
| **LOW** | 0-3 | When convenient | Historical data, minor symptoms |

## Golden Thread verification

The API automatically fuses CBS and EMR data using the Golden Thread protocol:

### Verification logic

```
IF cbs.location == emr.location AND |cbs.timestamp - emr.timestamp| < 24h
    THEN verification_score = 1.0 (CONFIRMED)
    ELSE score degrades based on conflict severity
```

### Verification scores

| Score | Status | Description |
|-------|--------|-------------|
| 1.0 | CONFIRMED | Multiple sources agree on location and time |
| 0.7-0.9 | PROBABLE | Partial agreement with minor conflicts |
| 0.4-0.6 | POSSIBLE | Significant conflicts but plausible |
| 0.0-0.3 | UNVERIFIED | Major conflicts or single source only |

## Sovereignty enforcement

All endpoints enforce SovereignGuardrail constraints:

```python
# Automatic sovereignty validation
guardrail.validate_action(
    action_type='Data_Processing',
    payload={
        'data_type': 'PHI',
        'processing_location': 'Edge_Node',
        'source': 'CHV_AMINA_HASSAN',
        'consent_token': 'CBS_EMERGENCY'
    },
    jurisdiction='KDPA_KE'
)
```

**Blocked actions:**
- Cross-border data transfers without authorization
- Processing without valid consent token
- High-risk inferences without explanation

## Mobile app integration

### Flutter example

```dart
import 'package:http/http.dart' as http;
import 'dart:convert';

class ILuminaraAPI {
  final String baseUrl = 'https://api.iluminara.health/api/v1';
  
  Future<Map<String, dynamic>> submitCBSSignal({
    required String patientId,
    required double lat,
    required double lng,
    required String symptom,
    required int severity,
  }) async {
    final response = await http.post(
      Uri.parse('$baseUrl/cbs/submit'),
      headers: {'Content-Type': 'application/json'},
      body: jsonEncode({
        'patient_id': patientId,
        'location': {'lat': lat, 'lng': lng},
        'symptom': symptom,
        'severity': severity,
        'timestamp': DateTime.now().toIso8601String(),
        'source': 'MOBILE_APP',
        'jurisdiction': 'KDPA_KE',
      }),
    );
    
    if (response.statusCode == 201) {
      return jsonDecode(response.body);
    } else {
      throw Exception('Failed to submit CBS signal');
    }
  }
  
  Future<Map<String, dynamic>> checkSyncStatus() async {
    final response = await http.get(
      Uri.parse('$baseUrl/sync/status'),
    );
    
    return jsonDecode(response.body);
  }
}
```

### React Native example

```javascript
import axios from 'axios';

const API_BASE_URL = 'https://api.iluminara.health/api/v1';

export const submitCBSSignal = async (data) => {
  try {
    const response = await axios.post(`${API_BASE_URL}/cbs/submit`, {
      patient_id: data.patientId,
      location: { lat: data.lat, lng: data.lng },
      symptom: data.symptom,
      severity: data.severity,
      timestamp: new Date().toISOString(),
      source: 'MOBILE_APP',
      jurisdiction: 'KDPA_KE',
    });
    
    return response.data;
  } catch (error) {
    console.error('CBS submission failed:', error);
    throw error;
  }
};

export const checkSyncStatus = async () => {
  const response = await axios.get(`${API_BASE_URL}/sync/status`);
  return response.data;
};
```

## Offline-first implementation

### Local queue management

```python
import sqlite3
from datetime import datetime

class OfflineQueue:
    def __init__(self, db_path='offline_queue.db'):
        self.conn = sqlite3.connect(db_path)
        self._create_table()
    
    def _create_table(self):
        self.conn.execute('''
            CREATE TABLE IF NOT EXISTS sync_queue (
                id INTEGER PRIMARY KEY,
                signal_id TEXT,
                data TEXT,
                priority INTEGER,
                created_at TEXT,
                synced INTEGER DEFAULT 0
            )
        ''')
    
    def enqueue(self, signal_id, data, priority):
        self.conn.execute(
            'INSERT INTO sync_queue (signal_id, data, priority, created_at) VALUES (?, ?, ?, ?)',
            (signal_id, json.dumps(data), priority, datetime.utcnow().isoformat())
        )
        self.conn.commit()
    
    def get_pending(self, priority=None):
        if priority:
            cursor = self.conn.execute(
                'SELECT * FROM sync_queue WHERE synced = 0 AND priority = ? ORDER BY created_at',
                (priority,)
            )
        else:
            cursor = self.conn.execute(
                'SELECT * FROM sync_queue WHERE synced = 0 ORDER BY priority, created_at'
            )
        return cursor.fetchall()
    
    def mark_synced(self, signal_id):
        self.conn.execute(
            'UPDATE sync_queue SET synced = 1 WHERE signal_id = ?',
            (signal_id,)
        )
        self.conn.commit()
```

## Error handling

### Common errors

| Status Code | Error | Description |
|-------------|-------|-------------|
| 400 | `missing_fields` | Required fields not provided |
| 400 | `missing_patient_id` | Patient ID required but not provided |
| 403 | `sovereignty_violation` | Action violates compliance rules |
| 500 | `processing_failed` | Internal processing error |

### Example error response

```json
{
  "status": "error",
  "error": "sovereignty_violation",
  "message": "Violates GDPR Art. 9 (Processing of special categories)"
}
```

## Deployment

### Local development

```bash
# Install dependencies
pip install flask flask-cors google-cloud-pubsub

# Set environment variables
export API_PORT=8080
export JURISDICTION=KDPA_KE
export DEBUG=true

# Run API
python integrations/bio_interface_api.py
```

### Production (Cloud Run)

```bash
# Deploy to Cloud Run
gcloud run deploy bio-interface-api \
  --source integrations/ \
  --region us-central1 \
  --allow-unauthenticated \
  --set-env-vars JURISDICTION=KDPA_KE
```

## Next steps

<CardGroup cols={2}>
  <Card
    title="Golden Thread"
    icon="link"
    href="/architecture/golden-thread"
  >
    Understand data fusion logic
  </Card>
  <Card
    title="Vertex AI + SHAP"
    icon="brain-circuit"
    href="/integrations/vertex-ai-shap"
  >
    AI explainability integration
  </Card>
  <Card
    title="Governance"
    icon="shield-check"
    href="/governance/overview"
  >
    Sovereignty enforcement
  </Card>
  <Card
    title="AI agents"
    icon="robot"
    href="/ai-agents/overview"
  >
    Autonomous surveillance
  </Card>
</CardGroup>
