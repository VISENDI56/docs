---
title: Bio-Interface REST API
description: Mobile health apps integration with Golden Thread protocol
---

## Overview

The Bio-Interface REST API enables mobile health applications to integrate with iLuminara-Core using the Golden Thread protocol for data verification and fusion.

<Card
  title="Philosophy"
  icon="mobile"
>
  "Every signal is verified. CBS + EMR + IDSR = Golden Thread."
</Card>

## Key features

<CardGroup cols={2}>
  <Card title="Golden Thread fusion" icon="link">
    Automatic verification when CBS and EMR signals match
  </Card>
  <Card title="Sovereignty enforcement" icon="shield-check">
    All data validated against SovereignGuardrail
  </Card>
  <Card title="Voice processing" icon="microphone">
    Convert voice alerts to structured CBS reports
  </Card>
  <Card title="Real-time verification" icon="check-double">
    Instant verification status for all submissions
  </Card>
</CardGroup>

## Verification logic

The Golden Thread verifies data by cross-referencing multiple sources:

```
IF cbs.location == emr.location AND |cbs.timestamp - emr.timestamp| < 24h
    THEN verification_score = 1.0 (CONFIRMED)
    ELSE score degrades based on conflict severity
```

### Verification scores

| Score | Status | Description |
|-------|--------|-------------|
| 1.0 | **CONFIRMED** | Multiple sources agree on location and time |
| 0.7-0.9 | **PROBABLE** | Partial agreement with minor conflicts |
| 0.4-0.6 | **POSSIBLE** | Significant conflicts but plausible |
| 0.0-0.3 | **UNVERIFIED** | Major conflicts or single source only |

## API endpoints

### Base URL

```
http://localhost:8080/api/v1
```

For production: `https://your-domain.com/api/v1`

### Authentication

Currently no authentication for local development. For production, implement:
- API keys
- OAuth 2.0
- Google Cloud IAM

## Submit CBS report

Submit Community-Based Surveillance report from CHV or mobile app.

### Endpoint

```
POST /api/v1/cbs/report
```

### Request body

```json
{
  "location": {
    "lat": 0.0512,
    "lng": 40.3129
  },
  "symptoms": ["fever", "diarrhea", "vomiting"],
  "severity": 8,
  "reporter_id": "CHV_AMINA_HASSAN",
  "patient_id": "PAT_12345",
  "metadata": {
    "village": "Ifo Camp",
    "contact": "+254712345678"
  }
}
```

### Response

```json
{
  "status": "success",
  "timestamp": "2025-12-25T16:00:00.000Z",
  "cbs_report": {
    "location": {"lat": 0.0512, "lng": 40.3129},
    "symptoms": ["fever", "diarrhea", "vomiting"],
    "severity": 8,
    "timestamp": "2025-12-25T16:00:00.000Z",
    "source": "community_based_surveillance",
    "reporter_id": "CHV_AMINA_HASSAN"
  },
  "patient_id": "PAT_12345",
  "fused": true,
  "verification_score": 1.0,
  "verification_status": "CONFIRMED"
}
```

### Example

```bash
curl -X POST http://localhost:8080/api/v1/cbs/report \
  -H "Content-Type: application/json" \
  -d '{
    "location": {"lat": 0.0512, "lng": 40.3129},
    "symptoms": ["fever", "diarrhea"],
    "severity": 8,
    "reporter_id": "CHV_001",
    "patient_id": "PAT_12345"
  }'
```

## Submit EMR record

Submit Electronic Medical Record from clinic or hospital.

### Endpoint

```
POST /api/v1/emr/record
```

### Request body

```json
{
  "patient_id": "PAT_12345",
  "location": {
    "lat": 0.0512,
    "lng": 40.3129
  },
  "diagnosis": "Cholera",
  "symptoms": ["severe diarrhea", "vomiting", "dehydration"],
  "treatment": "ORS + IV fluids + Doxycycline",
  "facility_id": "DADAAB_CLINIC_01",
  "metadata": {
    "admission_date": "2025-12-25",
    "consent_token": "VALID_CONSENT_TOKEN"
  }
}
```

### Response

```json
{
  "status": "success",
  "timestamp": "2025-12-25T16:30:00.000Z",
  "emr_record": {
    "patient_id": "PAT_12345",
    "location": {"lat": 0.0512, "lng": 40.3129},
    "diagnosis": "Cholera",
    "symptoms": ["severe diarrhea", "vomiting", "dehydration"],
    "treatment": "ORS + IV fluids + Doxycycline",
    "timestamp": "2025-12-25T16:30:00.000Z",
    "source": "electronic_medical_record",
    "facility_id": "DADAAB_CLINIC_01"
  },
  "patient_id": "PAT_12345",
  "fused": true,
  "verification_score": 1.0,
  "verification_status": "CONFIRMED"
}
```

### Example

```bash
curl -X POST http://localhost:8080/api/v1/emr/record \
  -H "Content-Type: application/json" \
  -d '{
    "patient_id": "PAT_12345",
    "location": {"lat": 0.0512, "lng": 40.3129},
    "diagnosis": "Cholera",
    "symptoms": ["diarrhea", "vomiting"],
    "treatment": "ORS + Doxycycline",
    "facility_id": "CLINIC_01"
  }'
```

## Process voice alert

Process voice alert from mobile app and convert to CBS report.

### Endpoint

```
POST /api/v1/voice/alert?location={location}&reporter_id={reporter_id}&language={language}
```

### Query parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `location` | JSON | Yes | `{"lat": 0.0512, "lng": 40.3129}` |
| `reporter_id` | string | Yes | CHV identifier |
| `language` | string | No | Audio language (default: "swahili") |

### Request body

Raw audio data (WAV format recommended)

### Response

```json
{
  "status": "success",
  "timestamp": "2025-12-25T16:00:00.000Z",
  "cbs_report": {
    "location": {"lat": 0.0512, "lng": 40.3129},
    "symptoms": ["fever", "cough"],
    "severity": 6,
    "transcription": "Patient reporting fever and cough for 3 days",
    "language": "swahili"
  },
  "fused": false,
  "verification_score": null
}
```

### Example

```bash
curl -X POST "http://localhost:8080/api/v1/voice/alert?location=%7B%22lat%22%3A0.0512%2C%22lng%22%3A40.3129%7D&reporter_id=CHV_001&language=swahili" \
  -H "Content-Type: audio/wav" \
  --data-binary @voice-alert.wav
```

## Get verification status

Get Golden Thread verification status for a patient.

### Endpoint

```
GET /api/v1/verification/{patient_id}
```

### Response

```json
{
  "status": "success",
  "patient_id": "PAT_12345",
  "records_found": 2,
  "average_verification_score": 1.0,
  "verification_status": "CONFIRMED",
  "records": [
    {
      "source": "community_based_surveillance",
      "timestamp": "2025-12-25T16:00:00.000Z",
      "location": {"lat": 0.0512, "lng": 40.3129},
      "symptoms": ["fever", "diarrhea"],
      "verification_score": 1.0
    },
    {
      "source": "electronic_medical_record",
      "timestamp": "2025-12-25T16:30:00.000Z",
      "location": {"lat": 0.0512, "lng": 40.3129},
      "diagnosis": "Cholera",
      "verification_score": 1.0
    }
  ]
}
```

### Example

```bash
curl http://localhost:8080/api/v1/verification/PAT_12345
```

## Mobile app integration

### Android example

```kotlin
import okhttp3.*
import org.json.JSONObject

class ILuminaraClient(private val baseUrl: String) {
    private val client = OkHttpClient()
    
    fun submitCBSReport(
        location: Location,
        symptoms: List<String>,
        severity: Int,
        reporterId: String,
        patientId: String?
    ): Response {
        val json = JSONObject().apply {
            put("location", JSONObject().apply {
                put("lat", location.latitude)
                put("lng", location.longitude)
            })
            put("symptoms", JSONArray(symptoms))
            put("severity", severity)
            put("reporter_id", reporterId)
            patientId?.let { put("patient_id", it) }
        }
        
        val request = Request.Builder()
            .url("$baseUrl/api/v1/cbs/report")
            .post(RequestBody.create(
                MediaType.parse("application/json"),
                json.toString()
            ))
            .build()
        
        return client.newCall(request).execute()
    }
    
    fun submitVoiceAlert(
        audioFile: File,
        location: Location,
        reporterId: String
    ): Response {
        val url = "$baseUrl/api/v1/voice/alert?" +
            "location=${URLEncoder.encode(
                "{\"lat\":${location.latitude},\"lng\":${location.longitude}}",
                "UTF-8"
            )}&reporter_id=$reporterId"
        
        val request = Request.Builder()
            .url(url)
            .post(RequestBody.create(
                MediaType.parse("audio/wav"),
                audioFile
            ))
            .build()
        
        return client.newCall(request).execute()
    }
}
```

### iOS example

```swift
import Foundation

class ILuminaraClient {
    let baseURL: String
    
    init(baseURL: String) {
        self.baseURL = baseURL
    }
    
    func submitCBSReport(
        location: CLLocationCoordinate2D,
        symptoms: [String],
        severity: Int,
        reporterId: String,
        patientId: String?,
        completion: @escaping (Result<Data, Error>) -> Void
    ) {
        let url = URL(string: "\(baseURL)/api/v1/cbs/report")!
        var request = URLRequest(url: url)
        request.httpMethod = "POST"
        request.setValue("application/json", forHTTPHeaderField: "Content-Type")
        
        let body: [String: Any] = [
            "location": [
                "lat": location.latitude,
                "lng": location.longitude
            ],
            "symptoms": symptoms,
            "severity": severity,
            "reporter_id": reporterId,
            "patient_id": patientId as Any
        ]
        
        request.httpBody = try? JSONSerialization.data(withJSONObject: body)
        
        URLSession.shared.dataTask(with: request) { data, response, error in
            if let error = error {
                completion(.failure(error))
            } else if let data = data {
                completion(.success(data))
            }
        }.resume()
    }
}
```

## Sovereignty compliance

All API endpoints enforce sovereignty constraints:

```python
from governance_kernel.vector_ledger import SovereignGuardrail

guardrail = SovereignGuardrail()

# Validate data processing
guardrail.validate_action(
    action_type='Data_Processing',
    payload={
        'data_type': 'PHI',
        'processing_location': 'Edge_Node',
        'source': 'mobile_health_app'
    },
    jurisdiction='KDPA_KE'
)
```

## Error handling

### Common errors

| Error Code | HTTP Status | Description |
|------------|-------------|-------------|
| `sovereignty_violation` | 403 | Action violates compliance rules |
| `submission_failed` | 400 | Invalid request data |
| `processing_failed` | 400 | Voice processing failed |
| `query_failed` | 400 | Verification query failed |

### Error response

```json
{
  "status": "error",
  "error": "sovereignty_violation",
  "message": "Violates GDPR Art. 9 (Processing of special categories)"
}
```

## Testing

### Start the API server

```bash
python api/bio_interface.py
```

### Run tests

```bash
pytest tests/test_bio_interface.py -v
```

### Integration test

```bash
# Submit CBS report
curl -X POST http://localhost:8080/api/v1/cbs/report \
  -H "Content-Type: application/json" \
  -d '{"location": {"lat": 0.0512, "lng": 40.3129}, "symptoms": ["fever"], "severity": 5, "reporter_id": "CHV_001", "patient_id": "PAT_001"}'

# Submit EMR record (should fuse with CBS)
curl -X POST http://localhost:8080/api/v1/emr/record \
  -H "Content-Type: application/json" \
  -d '{"patient_id": "PAT_001", "location": {"lat": 0.0512, "lng": 40.3129}, "diagnosis": "Malaria", "symptoms": ["fever"], "treatment": "ACT", "facility_id": "CLINIC_01"}'

# Check verification
curl http://localhost:8080/api/v1/verification/PAT_001
```

## Deployment

### Docker

```dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

EXPOSE 8080

CMD ["python", "api/bio_interface.py"]
```

### Cloud Run

```bash
gcloud run deploy bio-interface-api \
  --source . \
  --platform managed \
  --region us-central1 \
  --allow-unauthenticated \
  --set-env-vars JURISDICTION=KDPA_KE
```

## Next steps

<CardGroup cols={2}>
  <Card
    title="Golden Thread"
    icon="link"
    href="/architecture/golden-thread"
  >
    Understand data fusion logic
  </Card>
  <Card
    title="Voice processing"
    icon="microphone"
    href="/api-reference/voice-processing"
  >
    Process voice alerts
  </Card>
  <Card
    title="SovereignGuardrail"
    icon="shield-check"
    href="/governance/overview"
  >
    Configure compliance enforcement
  </Card>
  <Card
    title="Deploy to GCP"
    icon="cloud"
    href="/deployment/gcp"
  >
    Production deployment guide
  </Card>
</CardGroup>
