---
title: IP-05 Golden Thread
description: Quantum entanglement logic fuses vague signals into verified timelines
---

## Overview

The Golden Thread (IP-05) is iLuminara's data fusion engine that merges three independent data streams into a single verified timeline using quantum entanglement logic.

<Card
  title="Philosophy"
  icon="link"
>
  "Three vague signals become one verified truth through mathematical entanglement."
</Card>

## The problem

Health surveillance data exists in silos:

- **EMR (Electronic Medical Records)** - Hospital/clinic data (high quality, low coverage)
- **CBS (Community-Based Surveillance)** - CHV reports (low quality, high coverage)
- **IDSR (Integrated Disease Surveillance Response)** - Government reports (medium quality, medium coverage)

**Result:** Incomplete picture, delayed outbreak detection, conflicting information.

## The solution

Golden Thread fuses all three streams with cross-source verification:

<Steps>
  <Step title="Collect signals">
    Ingest data from EMR, CBS, and IDSR sources
  </Step>
  <Step title="Cross-verify">
    Match signals by location and time (±24h window)
  </Step>
  <Step title="Calculate confidence">
    Assign verification score based on agreement
  </Step>
  <Step title="Generate timeline">
    Create single verified timeline from fused data
  </Step>
</Steps>

## Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                    GOLDEN THREAD ENGINE                      │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │              DATA INGESTION LAYER                     │  │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐           │  │
│  │  │   EMR    │  │   CBS    │  │   IDSR   │           │  │
│  │  │ Hospital │  │   CHV    │  │   Govt   │           │  │
│  │  │  Records │  │  Reports │  │  Reports │           │  │
│  │  └────┬─────┘  └────┬─────┘  └────┬─────┘           │  │
│  │       └─────────────┼─────────────┘                  │  │
│  └─────────────────────┼──────────────────────────────────┘  │
│                        │                                     │
│  ┌─────────────────────▼──────────────────────────────────┐  │
│  │           CROSS-VERIFICATION LAYER                     │  │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐           │  │
│  │  │ Location │  │   Time   │  │ Symptom  │           │  │
│  │  │ Matching │  │ Matching │  │ Matching │           │  │
│  │  └────┬─────┘  └────┬─────┘  └────┬─────┘           │  │
│  │       └─────────────┼─────────────┘                  │  │
│  │                     ▼                                 │  │
│  │           ┌──────────────────┐                        │  │
│  │           │ VERIFICATION     │                        │  │
│  │           │ SCORE (0.0-1.0)  │                        │  │
│  │           └────────┬─────────┘                        │  │
│  └────────────────────┼──────────────────────────────────┘  │
│                       │                                     │
│  ┌────────────────────▼──────────────────────────────────┐  │
│  │           TIMELINE GENERATION LAYER                   │  │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐           │  │
│  │  │  Fused   │  │ Conflict │  │  Audit   │           │  │
│  │  │  Record  │  │Resolution│  │   Trail  │           │  │
│  │  └────┬─────┘  └────┬─────┘  └────┬─────┘           │  │
│  │       └─────────────┼─────────────┘                  │  │
│  │                     ▼                                 │  │
│  │           ┌──────────────────┐                        │  │
│  │           │  VERIFIED        │                        │  │
│  │           │  TIMELINE        │                        │  │
│  │           └──────────────────┘                        │  │
│  └───────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

## Verification logic

```python
def calculate_verification_score(cbs_signal, emr_record):
    """
    Calculate verification score based on cross-source agreement.
    
    Score calculation:
    - Location match: +0.4
    - Time match (±24h): +0.3
    - Symptom match: +0.3
    """
    score = 0.0
    
    # Location matching
    if cbs_signal.location == emr_record.location:
        score += 0.4
    elif distance(cbs_signal.location, emr_record.location) < 5km:
        score += 0.2  # Partial match
    
    # Time matching
    time_delta = abs(cbs_signal.timestamp - emr_record.timestamp)
    if time_delta < 24hours:
        score += 0.3
    elif time_delta < 48hours:
        score += 0.15  # Partial match
    
    # Symptom matching
    if cbs_signal.symptom in emr_record.diagnosis:
        score += 0.3
    elif symptom_related(cbs_signal.symptom, emr_record.diagnosis):
        score += 0.15  # Partial match
    
    return score
```

## Verification scores

| Score | Status | Description | Action |
|-------|--------|-------------|--------|
| **1.0** | CONFIRMED | Perfect match across all sources | High confidence |
| **0.7-0.9** | PROBABLE | Strong agreement with minor conflicts | Medium confidence |
| **0.4-0.6** | POSSIBLE | Significant conflicts but plausible | Low confidence |
| **0.0-0.3** | UNVERIFIED | Major conflicts or single source | Investigate |

## Basic usage

```python
from edge_node.sync_protocol.golden_thread import GoldenThread

gt = GoldenThread()

# CBS signal from CHV
cbs_signal = {
    'location': 'Dadaab',
    'symptom': 'diarrhea',
    'timestamp': '2025-12-23T08:00:00Z',
    'source': 'CHV_AMINA_HASSAN'
}

# EMR record from clinic
emr_record = {
    'location': 'Dadaab',
    'diagnosis': 'cholera',
    'timestamp': '2025-12-23T08:30:00Z',
    'source': 'DADAAB_CLINIC'
}

# Fuse data streams
fused = gt.fuse_data_streams(
    cbs_signal=cbs_signal,
    emr_record=emr_record,
    patient_id='PAT_001'
)

# Check verification
print(f"Verification Score: {fused.verification_score}")  # 1.0 (CONFIRMED)
print(f"Status: {fused.status}")  # CONFIRMED
print(f"Fused Record: {fused.to_dict()}")
```

## Real-world example

### Cholera outbreak in Dadaab

**Day 1 - CBS Signal:**
```python
cbs_signal = {
    'location': {'lat': 0.0512, 'lng': 40.3129},
    'symptom': 'severe_diarrhea',
    'timestamp': '2025-12-20T06:00:00Z',
    'severity': 9,
    'source': 'CHV_AMINA_HASSAN'
}
```

**Day 1 - EMR Record:**
```python
emr_record = {
    'location': {'lat': 0.0512, 'lng': 40.3129},
    'diagnosis': 'cholera',
    'timestamp': '2025-12-20T07:30:00Z',
    'lab_confirmed': True,
    'source': 'DADAAB_CLINIC'
}
```

**Golden Thread Fusion:**
```python
fused = gt.fuse_data_streams(
    cbs_signal=cbs_signal,
    emr_record=emr_record,
    patient_id='PAT_CHOLERA_001'
)

# Result:
# verification_score: 1.0 (CONFIRMED)
# - Location: EXACT MATCH
# - Time: 1.5h delta (< 24h) ✓
# - Symptom: "severe_diarrhea" matches "cholera" ✓
# - Lab confirmed: YES ✓
#
# Status: OUTBREAK CONFIRMED
# Alert Level: CRITICAL
# Recommendation: Immediate response required
```

## Conflict resolution

When sources disagree, Golden Thread applies resolution rules:

### Rule 1: Location conflict

```python
if cbs_signal.location != emr_record.location:
    # Prefer EMR location (ground truth)
    fused.location = emr_record.location
    
    # But flag CBS location for investigation
    fused.conflicts.append({
        'type': 'location_mismatch',
        'cbs_location': cbs_signal.location,
        'emr_location': emr_record.location,
        'action': 'investigate'
    })
```

### Rule 2: Time conflict

```python
if abs(cbs_signal.timestamp - emr_record.timestamp) > 24hours:
    # Create separate events
    event_1 = create_event(cbs_signal)
    event_2 = create_event(emr_record)
    
    # Link as potentially related
    event_1.related_events.append(event_2.id)
```

### Rule 3: Diagnosis conflict

```python
if cbs_signal.symptom != emr_record.diagnosis:
    # Prefer EMR diagnosis (clinical expertise)
    fused.diagnosis = emr_record.diagnosis
    
    # Include CBS symptom for context
    fused.reported_symptoms = [cbs_signal.symptom]
```

### Rule 4: Severity conflict

```python
if cbs_signal.severity != emr_record.severity:
    # Use maximum severity (err on side of caution)
    fused.severity = max(cbs_signal.severity, emr_record.severity)
```

## IDSR integration

Golden Thread auto-generates IDSR reports for government submission:

```python
# Generate weekly IDSR report
idsr_report = gt.generate_idsr_report(
    start_date='2025-12-16',
    end_date='2025-12-23',
    location='Dadaab'
)

# Report includes:
# - Case counts by disease
# - Geographic distribution
# - Temporal trends
# - Verification scores
# - Data sources (CBS, EMR)
```

**Example IDSR report:**
```
IDSR Weekly Report - Dadaab
Week 51, 2025 (Dec 16-23)

Disease: Cholera
- Total cases: 47
- Confirmed (EMR): 35
- Suspected (CBS): 12
- Verification rate: 74%
- Trend: INCREASING (+23% vs previous week)
- Alert level: HIGH

Geographic distribution:
- Ifo Camp: 28 cases
- Dagahaley Camp: 12 cases
- Hagadera Camp: 7 cases

Data sources:
- EMR: 35 records (Dadaab Hospital, Ifo Clinic)
- CBS: 47 reports (12 CHVs)
- Verification: 35/47 confirmed (74%)
```

## Data quality metrics

```python
# Get quality metrics
metrics = gt.get_quality_metrics()

print(f"CBS coverage: {metrics['cbs_coverage']:.1%}")
print(f"EMR coverage: {metrics['emr_coverage']:.1%}")
print(f"Verification rate: {metrics['verification_rate']:.1%}")
print(f"Conflict rate: {metrics['conflict_rate']:.1%}")
```

### Quality thresholds

| Metric | Good | Warning | Critical |
|--------|------|---------|----------|
| **Verification rate** | >80% | 60-80% | <60% |
| **Conflict rate** | <10% | 10-20% | >20% |
| **CBS coverage** | >70% | 50-70% | <50% |
| **EMR coverage** | >60% | 40-60% | <40% |

## Performance

- **Fusion latency:** <50ms per record
- **Throughput:** 1000+ records/second
- **Storage:** Efficient time-series compression
- **Query speed:** <100ms for recent data (HOT storage)

## Next steps

<CardGroup cols={2}>
  <Card
    title="Bio-Interface API"
    icon="mobile"
    href="/api-reference/bio-interface"
  >
    Submit CBS signals from mobile apps
  </Card>
  <Card
    title="Voice processing"
    icon="microphone"
    href="/api-reference/voice-processing"
  >
    Create CBS signals from voice alerts
  </Card>
  <Card
    title="AI agents"
    icon="brain-circuit"
    href="/ai-agents/overview"
  >
    Use fused data for surveillance
  </Card>
  <Card
    title="Deployment"
    icon="rocket"
    href="/deployment/overview"
  >
    Deploy Golden Thread to production
  </Card>
</CardGroup>
