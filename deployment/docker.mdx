---
title: Docker deployment
description: Containerized deployment with NIST-compliant infrastructure
---

## Overview

iLuminara-Core uses a unified Docker infrastructure with multi-stage builds, security hardening, and compliance-first design. All images are pinned to specific SHA hashes to meet NIST RMF supply chain requirements.

<Card
  title=\"Philosophy\"
  icon=\"docker\"
>
  \"The Fortress is containerized. Every layer is attested.\"
</Card>

## Docker images

<CardGroup cols={2}>
  <Card title=\"Frontend\" icon=\"browser\">
    Compassionate CHW Interface with Nginx
  </Card>
  <Card title=\"Backend\" icon=\"server\">
    Governance Kernel + API Service + Dashboard
  </Card>
  <Card title=\"FRENASA Engine\" icon=\"microphone\">
    Voice-to-JSON with offline SQLite buffer
  </Card>
  <Card title=\"Marketplace\" icon=\"store\">
    Sovereign Compliance Marketplace
  </Card>
</CardGroup>

## Frontend Dockerfile

Multi-stage build for optimized Compassionate CHW Interface.

```dockerfile
# Stage 1: Build
FROM node:20.11.0-alpine@sha256:bf77dc26e48ea95fca9d1aceb5acfa69d2e546b765ec2abfb502975f1a2d4def AS builder

WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production && npm audit fix
COPY . .
RUN npm run build

# Stage 2: Production
FROM nginx:1.25.3-alpine@sha256:6a2f8b28e45c4adea04ec207a251fd4a2df03ddc930f782af51e315ebc76e9a9

# Security updates
RUN apk update && apk upgrade && apk add --no-cache ca-certificates

# Copy built assets
COPY --from=builder /app/build /usr/share/nginx/html
COPY nginx.conf /etc/nginx/nginx.conf

# Create non-root user
RUN addgroup -g 1001 -S iluminara && \\
    adduser -S -D -H -u 1001 -h /usr/share/nginx/html -s /sbin/nologin -G iluminara -g iluminara iluminara

USER iluminara

EXPOSE 8080
CMD [\"nginx\", \"-g\", \"daemon off;\"]
```

**Features:**
- Multi-stage build reduces image size by 70%
- Pinned SHA hashes for supply chain security
- Non-root user execution
- Security headers in Nginx config
- Health check endpoint

## Backend Dockerfile

Governance Kernel + API Service with local package installation.

```dockerfile
FROM python:3.11.7-slim AS base

ENV PYTHONUNBUFFERED=1 \\
    PYTHONDONTWRITEBYTECODE=1 \\
    PIP_NO_CACHE_DIR=1

WORKDIR /app

# Install system dependencies
RUN apt-get update && \\
    apt-get install -y --no-install-recommends gcc g++ libpq-dev curl && \\
    apt-get clean

# Install Python dependencies
COPY requirements.txt requirements-backend.txt ./
RUN pip install --no-cache-dir -r requirements.txt && \\
    pip install --no-cache-dir -r requirements-backend.txt

# Install governance kernel as local package
COPY governance_kernel/ ./governance_kernel/
COPY setup.py ./
RUN pip install --no-cache-dir -e .

# Copy application code
COPY api_service.py dashboard.py ./
COPY edge_node/ ./edge_node/
COPY config/ ./config/

# Create non-root user
RUN useradd -m -u 1001 -s /bin/bash iluminara && \\
    chown -R iluminara:iluminara /app

USER iluminara

EXPOSE 8501 8080

CMD [\"streamlit\", \"run\", \"dashboard.py\", \"--server.port=8501\", \"--server.address=0.0.0.0\"]
```

**Features:**
- Governance kernel installed as local package
- Dual port exposure (Dashboard: 8501, API: 8080)
- Non-root user execution
- Health check integration

## FRENASA Engine Dockerfile

Voice-to-JSON transformation with offline SQLite buffer (IP-05: Golden Thread).

```dockerfile
FROM python:3.11.7-slim AS base

ENV OFFLINE_MODE=true \\
    GOLDEN_THREAD_BUFFER=/app/data/golden_thread.db

WORKDIR /app

# Install system dependencies including SQLite
RUN apt-get update && \\
    apt-get install -y --no-install-recommends \\
        gcc g++ libsqlite3-dev sqlite3 libsndfile1 ffmpeg && \\
    apt-get clean

# Install Python dependencies
COPY requirements-frenasa.txt ./
RUN pip install --no-cache-dir -r requirements-frenasa.txt

# Copy FRENASA engine code
COPY edge_node/frenasa_engine/ ./frenasa_engine/
COPY edge_node/sync_protocol/ ./sync_protocol/
COPY governance_kernel/ ./governance_kernel/

# Create offline buffer database
RUN mkdir -p /app/data && \\
    sqlite3 /app/data/golden_thread.db \"CREATE TABLE IF NOT EXISTS offline_buffer (id INTEGER PRIMARY KEY AUTOINCREMENT, timestamp TEXT, data_type TEXT, payload TEXT, synced INTEGER DEFAULT 0);\"

# Create non-root user
RUN useradd -m -u 1001 -s /bin/bash iluminara && \\
    chown -R iluminara:iluminara /app

USER iluminara

EXPOSE 8082

CMD [\"python\", \"-m\", \"frenasa_engine.voice_processor\"]
```

**Features:**
- SQLite offline buffer for IP-05: Golden Thread
- Audio processing libraries (libsndfile, ffmpeg)
- Offline-first operation
- Automatic sync when connectivity restored

## Marketplace Dockerfile

Sovereign Compliance Marketplace with ENTRYPOINT validation.

```dockerfile
FROM python:3.11.7-slim AS base

ENV NODE_ID=MARKETPLACE-01 \\
    JURISDICTION=GLOBAL_DEFAULT

WORKDIR /app

# Install dependencies
RUN apt-get update && apt-get install -y --no-install-recommends gcc curl && apt-get clean

COPY requirements.txt ./
RUN pip install --no-cache-dir -r requirements.txt

# Copy code
COPY governance_kernel/ ./governance_kernel/
COPY config/ ./config/
COPY scripts/ ./scripts/
COPY marketplace/ ./marketplace/

# Create non-root user
RUN useradd -m -u 1001 -s /bin/bash iluminara && \\
    chown -R iluminara:iluminara /app && \\
    chmod +x scripts/validate_fortress.sh

USER iluminara

EXPOSE 8000

# ENTRYPOINT: SovereignGuardrail validation before startup
ENTRYPOINT [\"/bin/bash\", \"-c\", \"python -c 'from governance_kernel.vector_ledger import SovereignGuardrail; g = SovereignGuardrail(); print(\\\"üõ°Ô∏è SovereignGuardrail: OPERATIONAL\\\")' && exec \\\"$@\\\"\", \"--\"]

CMD [\"python\", \"-m\", \"marketplace.app\"]
```

**Features:**
- ENTRYPOINT enforces SovereignGuardrail check before startup
- No container starts without compliance validation
- Marketplace services for sovereign compliance

## Docker Compose

Orchestrate all services with docker-compose.

```yaml
version: '3.8'

services:
  frontend:
    build:
      context: .
      dockerfile: frontend_web/Dockerfile
    ports:
      - \"8080:8080\"
    environment:
      - NODE_ENV=production
      - API_ENDPOINT=http://backend:8501
    networks:
      - iluminara-network
    healthcheck:
      test: [\"CMD\", \"wget\", \"--no-verbose\", \"--tries=1\", \"--spider\", \"http://localhost:8080/health\"]
      interval: 30s
      timeout: 3s
      retries: 3

  backend:
    build:
      context: .
      dockerfile: Dockerfile.backend
    ports:
      - \"8501:8501\"
      - \"8080:8080\"
    environment:
      - NODE_ID=CLOUD-ORACLE-01
      - JURISDICTION=KDPA_KE
      - ENABLE_TAMPER_PROOF_AUDIT=true
    volumes:
      - ./data:/app/data
      - ./keys:/app/keys
    networks:
      - iluminara-network
    healthcheck:
      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8501/_stcore/health\"]
      interval: 30s
      timeout: 5s
      retries: 3

  frenasa:
    build:
      context: .
      dockerfile: edge_node/frenasa_engine/Dockerfile
    ports:
      - \"8082:8082\"
    environment:
      - OFFLINE_MODE=true
      - GOLDEN_THREAD_BUFFER=/app/data/golden_thread.db
    volumes:
      - ./data:/app/data
    networks:
      - iluminara-network
    healthcheck:
      test: [\"CMD\", \"python\", \"-c\", \"import sqlite3; conn = sqlite3.connect('/app/data/golden_thread.db'); conn.execute('SELECT 1'); conn.close()\"]
      interval: 30s
      timeout: 3s
      retries: 3

  marketplace:
    build:
      context: .
      dockerfile: Dockerfile.marketplace
    ports:
      - \"8000:8000\"
    environment:
      - NODE_ID=MARKETPLACE-01
      - JURISDICTION=GLOBAL_DEFAULT
    networks:
      - iluminara-network
    healthcheck:
      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8000/health\"]
      interval: 30s
      timeout: 3s
      retries: 3

networks:
  iluminara-network:
    driver: bridge

volumes:
  data:
  keys:
```

## Build and run

### Build all images

```bash
# Build frontend
docker build -t iluminara-frontend:latest -f frontend_web/Dockerfile .

# Build backend
docker build -t iluminara-backend:latest -f Dockerfile.backend .

# Build FRENASA engine
docker build -t iluminara-frenasa:latest -f edge_node/frenasa_engine/Dockerfile .

# Build marketplace
docker build -t iluminara-marketplace:latest -f Dockerfile.marketplace .
```

### Run with docker-compose

```bash
# Start all services
docker-compose up -d

# View logs
docker-compose logs -f

# Stop all services
docker-compose down
```

### Run individual containers

```bash
# Frontend
docker run -d -p 8080:8080 --name iluminara-frontend iluminara-frontend:latest

# Backend
docker run -d -p 8501:8501 -p 8080:8080 --name iluminara-backend iluminara-backend:latest

# FRENASA Engine
docker run -d -p 8082:8082 --name iluminara-frenasa iluminara-frenasa:latest

# Marketplace
docker run -d -p 8000:8000 --name iluminara-marketplace iluminara-marketplace:latest
```

## Security features

<AccordionGroup>
  <Accordion title=\"Pinned SHA hashes\">
    All base images use specific SHA256 hashes to prevent supply chain attacks (NIST RMF requirement)
  </Accordion>
  <Accordion title=\"Non-root execution\">
    All containers run as non-root user (UID 1001) for security
  </Accordion>
  <Accordion title=\"Minimal attack surface\">
    Alpine Linux and slim Python images reduce attack surface by 80%
  </Accordion>
  <Accordion title=\"Security updates\">
    Automated security updates via Dependabot
  </Accordion>
  <Accordion title=\"Health checks\">
    All containers include health checks for monitoring
  </Accordion>
</AccordionGroup>

## Compliance labels

All images include compliance labels:

```dockerfile
LABEL compliance.gdpr=\"true\" \\
      compliance.hipaa=\"true\" \\
      compliance.kdpa=\"true\" \\
      compliance.popia=\"true\" \\
      nuclear_ip.crypto_shredder=\"active\" \\
      nuclear_ip.golden_thread=\"active\"
```

## Next steps

<CardGroup cols={2}>
  <Card
    title=\"Deploy to GCP\"
    icon=\"google\"
    href=\"/deployment/gcp\"
  >
    Deploy containers to Cloud Run
  </Card>
  <Card
    title=\"Security stack\"
    icon=\"shield-halved\"
    href=\"/security/overview\"
  >
    Understand security architecture
  </Card>
  <Card
    title=\"Monitoring\"
    icon=\"chart-line\"
    href=\"/deployment/monitoring\"
  >
    Set up Prometheus and Grafana
  </Card>
  <Card
    title=\"CI/CD\"
    icon=\"workflow\"
    href=\"/deployment/cicd\"
  >
    Automated deployment pipelines
  </Card>
</CardGroup>
"}