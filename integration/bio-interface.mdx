---
title: Bio-Interface REST API
description: Mobile health app integration with Golden Thread data fusion
---

## Overview

The Bio-Interface REST API enables mobile health applications to integrate with iLuminara-Core, providing seamless data collection from Community Health Volunteers (CHVs) with automatic Golden Thread verification.

<Card
  title="Philosophy"
  icon="mobile"
>
  "Zero-friction data collection with sovereign dignity preservation"
</Card>

## Architecture

```
┌─────────────────────────────────────────────────────────┐
│              MOBILE HEALTH APPS                         │
│  - CHV Data Collection                                  │
│  - Patient Registration                                 │
│  - Symptom Reporting                                    │
│  - Offline Sync                                         │
└─────────────────────────────────────────────────────────┘
                         │
                         │ HTTPS/TLS 1.3
                         ▼
┌─────────────────────────────────────────────────────────┐
│              BIO-INTERFACE REST API                     │
│  - Voice Processing (/process-voice)                   │
│  - Outbreak Prediction (/predict)                      │
│  - Data Submission (/submit-cbs)                       │
│  - Sync Protocol (/sync)                               │
└─────────────────────────────────────────────────────────┘
                         │
                         │ Golden Thread Fusion
                         ▼
┌─────────────────────────────────────────────────────────┐
│              GOLDEN THREAD ENGINE                       │
│  - CBS Signal Processing                                │
│  - EMR Cross-Verification                              │
│  - IDSR Report Generation                              │
│  - Verification Score Calculation                       │
└─────────────────────────────────────────────────────────┘
                         │
                         │ Sovereignty Validation
                         ▼
┌─────────────────────────────────────────────────────────┐
│              SOVEREIGNGUARDRAIL                         │
│  - Data Residency Enforcement                          │
│  - Consent Validation                                   │
│  - Audit Trail Logging                                  │
└─────────────────────────────────────────────────────────┘
```

## Core endpoints

### POST /submit-cbs

Submit Community-Based Surveillance (CBS) data from mobile apps.

**Request:**

```json
{
  "chv_id": "CHV_AMINA_HASSAN",
  "location": {
    "lat": 0.0512,
    "lng": 40.3129,
    "name": "Dadaab Refugee Camp"
  },
  "patient": {
    "id": "PAT_12345",
    "age": 28,
    "gender": "F"
  },
  "symptoms": ["diarrhea", "vomiting", "dehydration"],
  "severity": 9,
  "timestamp": "2025-12-23T10:00:00Z",
  "consent_token": "EMERGENCY_CHV_ALERT"
}
```

**Response:**

```json
{
  "status": "success",
  "cbs_id": "CBS_20251223_001",
  "verification_score": 0.0,
  "verification_status": "PENDING_EMR",
  "alert_level": "CRITICAL",
  "recommendations": [
    "IMMEDIATE: Suspected cholera. Start ORS immediately.",
    "Isolate patient to prevent spread",
    "Notify district health officer"
  ],
  "golden_thread": {
    "cbs_recorded": true,
    "emr_match": false,
    "idsr_generated": false
  }
}
```

### POST /sync

Sync offline data from mobile apps with conflict resolution.

**Request:**

```json
{
  "device_id": "DEVICE_CHV_001",
  "last_sync": "2025-12-23T08:00:00Z",
  "pending_records": [
    {
      "local_id": "LOCAL_001",
      "type": "cbs_report",
      "data": { /* CBS data */ },
      "timestamp": "2025-12-23T09:15:00Z"
    },
    {
      "local_id": "LOCAL_002",
      "type": "voice_alert",
      "data": { /* Voice data */ },
      "timestamp": "2025-12-23T09:30:00Z"
    }
  ]
}
```

**Response:**

```json
{
  "status": "success",
  "synced_count": 2,
  "conflicts": [],
  "server_records": [
    {
      "local_id": "LOCAL_001",
      "server_id": "CBS_20251223_001",
      "status": "synced"
    },
    {
      "local_id": "LOCAL_002",
      "server_id": "VOICE_20251223_001",
      "status": "synced"
    }
  ],
  "next_sync": "2025-12-23T10:00:00Z"
}
```

### GET /verify/{cbs_id}

Check verification status of a CBS report.

**Response:**

```json
{
  "cbs_id": "CBS_20251223_001",
  "verification_score": 1.0,
  "verification_status": "CONFIRMED",
  "matched_emr": {
    "emr_id": "EMR_20251223_045",
    "facility": "Dadaab Clinic",
    "diagnosis": "Cholera",
    "timestamp": "2025-12-23T10:30:00Z"
  },
  "time_delta_hours": 0.5,
  "location_match": true,
  "golden_thread": {
    "cbs_recorded": true,
    "emr_match": true,
    "idsr_generated": true
  }
}
```

## Golden Thread integration

All CBS submissions automatically enter the Golden Thread data fusion pipeline:

```python
from edge_node.sync_protocol.golden_thread import GoldenThread
from flask import Flask, request, jsonify

app = Flask(__name__)
gt = GoldenThread()

@app.route('/submit-cbs', methods=['POST'])
def submit_cbs():
    data = request.json
    
    # Create CBS signal
    cbs_signal = {
        'location': data['location']['name'],
        'symptom': data['symptoms'][0],
        'timestamp': data['timestamp'],
        'source': data['chv_id'],
        'severity': data['severity']
    }
    
    # Attempt fusion with existing EMR records
    fused = gt.fuse_data_streams(
        cbs_signal=cbs_signal,
        patient_id=data['patient']['id']
    )
    
    # Validate with SovereignGuardrail
    from governance_kernel.vector_ledger import SovereignGuardrail
    guardrail = SovereignGuardrail()
    
    guardrail.validate_action(
        action_type='Data_Processing',
        payload={
            'data_type': 'PHI',
            'processing_location': 'Edge_Node',
            'consent_token': data['consent_token']
        },
        jurisdiction='KDPA_KE'
    )
    
    return jsonify({
        'status': 'success',
        'cbs_id': fused.cbs_id,
        'verification_score': fused.verification_score,
        'verification_status': fused.verification_status,
        'alert_level': determine_alert_level(data['severity']),
        'golden_thread': {
            'cbs_recorded': True,
            'emr_match': fused.verification_score >= 0.8,
            'idsr_generated': False
        }
    })
```

## Verification logic

The Golden Thread uses cross-source verification:

```
IF cbs.location == emr.location AND |cbs.timestamp - emr.timestamp| < 24h
    THEN verification_score = 1.0 (CONFIRMED)
ELSE IF cbs.location == emr.location AND |cbs.timestamp - emr.timestamp| < 72h
    THEN verification_score = 0.7 (PROBABLE)
ELSE IF cbs.symptom matches emr.diagnosis
    THEN verification_score = 0.5 (POSSIBLE)
ELSE
    verification_score = 0.0 (UNVERIFIED)
```

### Verification statuses

| Score | Status | Description |
|-------|--------|-------------|
| 1.0 | CONFIRMED | CBS and EMR agree on location and time (<24h) |
| 0.7-0.9 | PROBABLE | Partial agreement with minor conflicts |
| 0.4-0.6 | POSSIBLE | Significant conflicts but plausible |
| 0.0-0.3 | UNVERIFIED | Major conflicts or single source only |

## Offline sync protocol

Mobile apps can queue data offline and sync when connectivity returns:

```javascript
// Mobile app (React Native example)
import AsyncStorage from '@react-native-async-storage/async-storage';

class iLuminaraSync {
  async submitCBS(cbsData) {
    // Try immediate submission
    try {
      const response = await fetch('https://api.iluminara.health/submit-cbs', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(cbsData)
      });
      
      if (response.ok) {
        return await response.json();
      }
    } catch (error) {
      // Network error - queue for later
      await this.queueForSync(cbsData);
      return { status: 'queued', message: 'Will sync when online' };
    }
  }
  
  async queueForSync(data) {
    const queue = await AsyncStorage.getItem('sync_queue') || '[]';
    const queueArray = JSON.parse(queue);
    
    queueArray.push({
      local_id: `LOCAL_${Date.now()}`,
      type: 'cbs_report',
      data: data,
      timestamp: new Date().toISOString()
    });
    
    await AsyncStorage.setItem('sync_queue', JSON.stringify(queueArray));
  }
  
  async syncPendingRecords() {
    const queue = await AsyncStorage.getItem('sync_queue') || '[]';
    const queueArray = JSON.parse(queue);
    
    if (queueArray.length === 0) return;
    
    const response = await fetch('https://api.iluminara.health/sync', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        device_id: await this.getDeviceId(),
        last_sync: await this.getLastSync(),
        pending_records: queueArray
      })
    });
    
    if (response.ok) {
      // Clear synced records
      await AsyncStorage.setItem('sync_queue', '[]');
      await this.setLastSync(new Date().toISOString());
    }
  }
}
```

## Authentication

### API key authentication

```bash
curl -X POST https://api.iluminara.health/submit-cbs \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{...}'
```

### Device registration

```python
@app.route('/register-device', methods=['POST'])
def register_device():
    data = request.json
    
    # Validate device
    device_id = generate_device_id()
    api_key = generate_api_key()
    
    # Store in database
    store_device({
        'device_id': device_id,
        'api_key': api_key,
        'chv_id': data['chv_id'],
        'location': data['location'],
        'registered_at': datetime.utcnow()
    })
    
    return jsonify({
        'device_id': device_id,
        'api_key': api_key,
        'expires_at': (datetime.utcnow() + timedelta(days=365)).isoformat()
    })
```

## Rate limiting

Configure rate limits to prevent abuse:

```python
from flask_limiter import Limiter
from flask_limiter.util import get_remote_address

limiter = Limiter(
    app,
    key_func=get_remote_address,
    default_limits=["100 per hour"]
)

@app.route('/submit-cbs', methods=['POST'])
@limiter.limit("10 per minute")
def submit_cbs():
    # ... implementation
    pass
```

## Data validation

All submissions are validated before processing:

```python
from marshmallow import Schema, fields, validate

class CBSSubmissionSchema(Schema):
    chv_id = fields.Str(required=True)
    location = fields.Dict(required=True, keys=fields.Str(), values=fields.Raw())
    patient = fields.Dict(required=True)
    symptoms = fields.List(fields.Str(), required=True, validate=validate.Length(min=1))
    severity = fields.Int(required=True, validate=validate.Range(min=0, max=10))
    timestamp = fields.DateTime(required=True)
    consent_token = fields.Str(required=True)

@app.route('/submit-cbs', methods=['POST'])
def submit_cbs():
    schema = CBSSubmissionSchema()
    
    try:
        validated_data = schema.load(request.json)
    except ValidationError as e:
        return jsonify({'status': 'error', 'errors': e.messages}), 400
    
    # Process validated data
    # ...
```

## Error handling

```python
@app.errorhandler(400)
def bad_request(error):
    return jsonify({
        'status': 'error',
        'error': 'bad_request',
        'message': str(error)
    }), 400

@app.errorhandler(403)
def forbidden(error):
    return jsonify({
        'status': 'error',
        'error': 'sovereignty_violation',
        'message': 'Action violates compliance rules'
    }), 403

@app.errorhandler(500)
def internal_error(error):
    return jsonify({
        'status': 'error',
        'error': 'internal_error',
        'message': 'Internal server error'
    }), 500
```

## Mobile SDK

### React Native SDK

```javascript
import iLuminaraSDK from '@iluminara/react-native-sdk';

// Initialize SDK
const sdk = new iLuminaraSDK({
  apiKey: 'YOUR_API_KEY',
  baseUrl: 'https://api.iluminara.health',
  offlineMode: true
});

// Submit CBS report
const result = await sdk.submitCBS({
  chv_id: 'CHV_AMINA_HASSAN',
  location: { lat: 0.0512, lng: 40.3129, name: 'Dadaab' },
  patient: { id: 'PAT_12345', age: 28, gender: 'F' },
  symptoms: ['diarrhea', 'vomiting'],
  severity: 9,
  consent_token: 'EMERGENCY_CHV_ALERT'
});

console.log(`CBS ID: ${result.cbs_id}`);
console.log(`Verification: ${result.verification_status}`);
```

### Flutter SDK

```dart
import 'package:iluminara_sdk/iluminara_sdk.dart';

// Initialize SDK
final sdk = ILuminaraSDK(
  apiKey: 'YOUR_API_KEY',
  baseUrl: 'https://api.iluminara.health',
  offlineMode: true,
);

// Submit CBS report
final result = await sdk.submitCBS(
  CBSReport(
    chvId: 'CHV_AMINA_HASSAN',
    location: Location(lat: 0.0512, lng: 40.3129, name: 'Dadaab'),
    patient: Patient(id: 'PAT_12345', age: 28, gender: 'F'),
    symptoms: ['diarrhea', 'vomiting'],
    severity: 9,
    consentToken: 'EMERGENCY_CHV_ALERT',
  ),
);

print('CBS ID: ${result.cbsId}');
print('Verification: ${result.verificationStatus}');
```

## Testing

```python
import pytest
from app import app

@pytest.fixture
def client():
    app.config['TESTING'] = True
    with app.test_client() as client:
        yield client

def test_submit_cbs(client):
    response = client.post('/submit-cbs', json={
        'chv_id': 'CHV_TEST',
        'location': {'lat': 0.0, 'lng': 0.0, 'name': 'Test'},
        'patient': {'id': 'PAT_TEST', 'age': 30, 'gender': 'M'},
        'symptoms': ['fever'],
        'severity': 5,
        'timestamp': '2025-12-23T10:00:00Z',
        'consent_token': 'TEST_TOKEN'
    })
    
    assert response.status_code == 200
    data = response.get_json()
    assert data['status'] == 'success'
    assert 'cbs_id' in data
```

## Next steps

<CardGroup cols={2}>
  <Card
    title="Golden Thread"
    icon="link"
    href="/architecture/golden-thread"
  >
    Understand data fusion logic
  </Card>
  <Card
    title="Voice processing"
    icon="microphone"
    href="/api-reference/voice-processing"
  >
    Integrate voice alerts
  </Card>
  <Card
    title="SovereignGuardrail"
    icon="shield-check"
    href="/governance/overview"
  >
    Configure compliance enforcement
  </Card>
  <Card
    title="Deploy API"
    icon="rocket"
    href="/deployment/gcp"
  >
    Deploy to production
  </Card>
</CardGroup>
