---
title: Implementation guide
description: Step-by-step guide to deploy the Sovereign Health Fortress security stack
---

## Overview

This guide walks you through implementing the complete iLuminara-Core security and integration stack, transforming your repository from code to a **Sovereign Health Fortress**.

<Warning>
  **Important:** All files in the `repository-files/` directory must be copied to your iLuminara-Core repository. This documentation repository cannot directly modify your code repository.
</Warning>

## Prerequisites

Before starting, ensure you have:

<Steps>
  <Step title="GitHub permissions">
    Workflow and write permissions for your repository
  </Step>
  <Step title="GCP project">
    Google Cloud Platform project with billing enabled (if using cloud features)
  </Step>
  <Step title="Python 3.8+">
    Python environment with pip installed
  </Step>
  <Step title="Git CLI">
    GitHub CLI (`gh`) installed and authenticated
  </Step>
</Steps>

## Step 1: Elevate agent permissions

Grant your GitHub Codespace the necessary permissions:

```bash
gh auth refresh -s workflow,repo,write:packages,admin:repo_hook
```

This enables:
- **workflow**: Modify GitHub Actions workflows
- **repo**: Full repository access
- **write:packages**: Publish packages
- **admin:repo_hook**: Manage webhooks

## Step 2: Copy repository files

All implementation files are located in the `repository-files/` directory of this documentation repository. Copy them to your iLuminara-Core repository:

### Security workflows

```bash
# Create workflows directory
mkdir -p .github/workflows

# Copy CodeQL workflow
cp repository-files/.github/workflows/codeql.yml .github/workflows/

# Copy Gitleaks workflow
cp repository-files/.github/workflows/gitleaks.yml .github/workflows/

# Copy Gitleaks config
cp repository-files/.gitleaks.toml .gitleaks.toml

# Copy Dependabot config
cp repository-files/.github/dependabot.yml .github/dependabot.yml
```

### Governance kernel

```bash
# Copy Crypto Shredder (IP-02)
cp repository-files/governance_kernel/crypto_shredder.py governance_kernel/

# Copy SovereignGuardrail config
mkdir -p config
cp repository-files/config/sovereign_guardrail.yaml config/
```

### Validation script

```bash
# Copy validation script
mkdir -p scripts
cp repository-files/scripts/validate_fortress.sh scripts/
chmod +x scripts/validate_fortress.sh
```

## Step 3: Install dependencies

Update your `requirements.txt` with security dependencies:

```txt
# Existing dependencies
streamlit>=1.28.0
pandas>=2.0.0
pydeck>=0.8.0
numpy>=1.24.0
Flask>=3.0.0
flask-cors>=4.0.0

# Security & Crypto
cryptography>=41.0.0
pyjwt>=2.8.0

# Google Cloud
google-cloud-bigquery>=3.11.0
google-cloud-spanner>=3.40.0
google-cloud-aiplatform>=1.38.0
google-cloud-kms>=2.19.0

# AI/ML
shap>=0.43.0
scikit-learn>=1.3.0

# Monitoring
prometheus-client>=0.19.0
```

Install dependencies:

```bash
pip install -r requirements.txt
```

## Step 4: Configure environment variables

Create a `.env` file in your repository root:

```bash
# Node identification
export NODE_ID=JOR-47
export JURISDICTION=KDPA_KE

# API configuration
export API_HOST=0.0.0.0
export API_PORT=8080

# GCP configuration (if using cloud)
export GOOGLE_CLOUD_PROJECT=your-project-id
export GCP_REGION=africa-south1

# Governance configuration
export ENABLE_TAMPER_PROOF_AUDIT=true
export RETENTION_MAX_DAYS=1825
export AUDIT_LOG_LEVEL=INFO

# Sovereignty settings
export DATA_SOVEREIGNTY_REQUIRED=true
export REQUIRES_EXPLICIT_CONSENT=true

# AI agents configuration
export ENABLE_OFFLINE_MODE=true
export SYNC_INTERVAL_SECONDS=300

# Federated learning
export FEDERATED_LEARNING_EPSILON=1.0
export FEDERATED_LEARNING_DELTA=1e-5
```

Load environment variables:

```bash
source .env
```

## Step 5: Commit and push changes

```bash
# Stage all changes
git add .

# Commit with descriptive message
git commit -m "feat: integrate SovereignGuardrail and Nuclear IP security stack

- Add CodeQL SAST scanning workflow
- Add Gitleaks secret detection workflow
- Implement IP-02 Crypto Shredder
- Add SovereignGuardrail configuration
- Configure Dependabot for daily security updates
- Add fortress validation script

Compliance: GDPR Art. 32, ISO 27001 A.12.6, HIPAA Â§164.312"

# Push to main branch
git push origin main
```

## Step 6: Enable branch protection

Protect your main branch with required status checks:

```bash
# Enable branch protection
gh api repos/:owner/:repo/branches/main/protection \
  --method PUT \
  --field required_status_checks[strict]=true \
  --field required_status_checks[contexts][]=CodeQL \
  --field required_status_checks[contexts][]=Gitleaks \
  --field required_pull_request_reviews[required_approving_review_count]=1 \
  --field enforce_admins=true \
  --field restrictions=null
```

Or configure via GitHub UI:
1. Go to **Settings** â†’ **Branches**
2. Add rule for `main` branch
3. Enable:
   - Require pull request reviews
   - Require status checks (CodeQL, Gitleaks)
   - Require branches to be up to date

## Step 7: Validate the fortress

Run the validation script to verify all components:

```bash
./scripts/validate_fortress.sh
```

Expected output:

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     iLuminara-Core Sovereign Health Fortress Validator     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PHASE 1: Security Audit Layer
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ Checking .github/workflows/codeql.yml... âœ“ EXISTS
   â””â”€ SAST security scanning (GDPR Art. 32, ISO 27001 A.12.6)
ğŸ“„ Checking .github/workflows/gitleaks.yml... âœ“ EXISTS
   â””â”€ Secret scanning (NIST SP 800-53 IA-5)
ğŸ“„ Checking .gitleaks.toml... âœ“ EXISTS
   â””â”€ Secret detection rules
ğŸ“„ Checking .github/dependabot.yml... âœ“ EXISTS
   â””â”€ Daily security updates

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PHASE 2: Governance Kernel (Nuclear IP Stack)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ Checking governance_kernel... âœ“ EXISTS
   â””â”€ Law-as-code enforcement engine
ğŸ“„ Checking governance_kernel/crypto_shredder.py... âœ“ EXISTS
   â””â”€ IP-02: Data dissolution (not deletion)
ğŸ“„ Checking config/sovereign_guardrail.yaml... âœ“ EXISTS
   â””â”€ Sovereignty configuration

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    VALIDATION SUMMARY                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ›¡ï¸  FORTRESS STATUS: OPERATIONAL
âœ“  All critical components validated
âœ“  Security audit layer active
âœ“  Governance kernel operational
âœ“  Nuclear IP stack initialized

The Sovereign Health Fortress is ready for deployment.
```

## Step 8: Test the security stack

### Test Crypto Shredder (IP-02)

```python
from governance_kernel.crypto_shredder import CryptoShredder, RetentionPolicy, SovereigntyZone

# Initialize
shredder = CryptoShredder(
    sovereignty_zone=SovereigntyZone.KENYA,
    enable_audit=True
)

# Encrypt patient data
patient_data = b"Patient ID: 12345, Diagnosis: Malaria"
encrypted_data, key_id = shredder.encrypt_with_ephemeral_key(
    data=patient_data,
    retention_policy=RetentionPolicy.HOT,
    metadata={"patient_id": "12345", "jurisdiction": "KDPA_KE"}
)

print(f"âœ… Encrypted - Key ID: {key_id}")

# Decrypt (while key exists)
decrypted = shredder.decrypt_with_key(encrypted_data, key_id)
print(f"âœ… Decrypted: {decrypted.decode()}")

# Shred key (data becomes irrecoverable)
shredder.shred_key(key_id)

# Try to decrypt after shredding
result = shredder.decrypt_with_key(encrypted_data, key_id)
print(f"âŒ After shred: {result}")  # None
```

### Test SovereignGuardrail

```python
from governance_kernel.vector_ledger import SovereignGuardrail, SovereigntyViolationError

guardrail = SovereignGuardrail()

# Test valid action
try:
    guardrail.validate_action(
        action_type='Data_Transfer',
        payload={'data_type': 'PHI', 'destination': 'Local_Node'},
        jurisdiction='KDPA_KE'
    )
    print("âœ… Valid action approved")
except SovereigntyViolationError as e:
    print(f"âŒ {e}")

# Test sovereignty violation
try:
    guardrail.validate_action(
        action_type='Data_Transfer',
        payload={'data_type': 'PHI', 'destination': 'AWS_US'},
        jurisdiction='GDPR_EU'
    )
except SovereigntyViolationError as e:
    print(f"âŒ Sovereignty violation detected: {e}")
```

## Step 9: Deploy to production

### Option A: Google Cloud Platform

```bash
# Deploy to GCP
chmod +x deploy_gcp_prototype.sh
./deploy_gcp_prototype.sh
```

### Option B: Edge deployment

```bash
# Deploy to edge node
chmod +x launch_all_services.sh
./launch_all_services.sh
```

### Option C: Docker

```bash
# Build and run
docker-compose up -d
```

## Step 10: Monitor the fortress

### Check security workflows

View workflow runs in GitHub:
- **CodeQL**: https://github.com/VISENDI56/iLuminara-Core/actions/workflows/codeql.yml
- **Gitleaks**: https://github.com/VISENDI56/iLuminara-Core/actions/workflows/gitleaks.yml

### Check Dependabot

View security updates:
- https://github.com/VISENDI56/iLuminara-Core/security/dependabot

### Monitor compliance

```bash
# Check audit logs
tail -f keys/audit.jsonl

# Check key status
python -c "
from governance_kernel.crypto_shredder import CryptoShredder
shredder = CryptoShredder()
status = shredder.get_key_status('YOUR_KEY_ID')
print(status)
"
```

## Troubleshooting

### CodeQL workflow fails

**Issue:** CodeQL analysis fails with "No code to analyze"

**Solution:** Ensure you have Python files in your repository:
```bash
find . -name "*.py" | head -5
```

### Gitleaks detects false positives

**Issue:** Gitleaks flags test data as secrets

**Solution:** Add to `.gitleaks.toml` allowlist:
```toml
[allowlist]
paths = [
  '''.*_test\\.py''',
  '''.*\\.example''',
]
```

### Crypto Shredder import error

**Issue:** `ModuleNotFoundError: No module named 'cryptography'`

**Solution:** Install dependencies:
```bash
pip install cryptography
```

### Permission denied on validation script

**Issue:** `./scripts/validate_fortress.sh: Permission denied`

**Solution:** Make script executable:
```bash
chmod +x scripts/validate_fortress.sh
```

## Nuclear IP Stack status

After implementation, your Nuclear IP Stack status:

| Component | Status | Notes |
|-----------|--------|-------|
| **IP-02: Crypto Shredder** | âœ… ACTIVE | Data dissolution implemented |
| **IP-03: Acorn Protocol** | âš ï¸ REQUIRES HARDWARE | TPM attestation needed |
| **IP-04: Silent Flux** | âš ï¸ REQUIRES INTEGRATION | Anxiety monitoring needed |
| **IP-05: Golden Thread** | âœ… ACTIVE | Data fusion operational |
| **IP-06: 5DM Bridge** | âš ï¸ REQUIRES MOBILE NETWORK | Mobile integration needed |

## Next steps

<CardGroup cols={2}>
  <Card
    title="Security overview"
    icon="shield-halved"
    href="/security/overview"
  >
    Deep dive into security architecture
  </Card>
  <Card
    title="Vertex AI integration"
    icon="brain"
    href="/integrations/vertex-ai-shap"
  >
    Implement explainable AI
  </Card>
  <Card
    title="Bio-Interface API"
    icon="mobile"
    href="/integrations/bio-interface"
  >
    Mobile app integration
  </Card>
  <Card
    title="Deployment"
    icon="rocket"
    href="/deployment/overview"
  >
    Production deployment guide
  </Card>
</CardGroup>

## Summary

You have successfully implemented:

âœ… **Security Audit Layer**
- CodeQL SAST scanning
- Gitleaks secret detection
- Dependabot daily updates

âœ… **Governance Kernel**
- SovereignGuardrail enforcement
- IP-02 Crypto Shredder
- Tamper-proof audit trail

âœ… **Compliance Framework**
- 14 global legal frameworks
- GDPR, KDPA, HIPAA, POPIA compliance
- EU AI Act Â§6 enforcement

âœ… **Validation & Monitoring**
- Fortress validation script
- Continuous compliance attestation
- Security metrics and alerts

**The Sovereign Health Fortress is now operational.** ğŸ›¡ï¸
